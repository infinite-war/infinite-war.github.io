{"title":"Java 网络编程基础","slug":"Java网络编程","date":"2022-01-15","updated":"2022-01-31","comments":true,"path":"api/posts/9017.json","excerpt":null,"cover":"https://img-blog.csdnimg.cn/c8ebcb0fe73e476ebbc27e551cba69ef.png?x-oss-process=image","covers":["https://img-blog.csdnimg.cn/c8ebcb0fe73e476ebbc27e551cba69ef.png?x-oss-process=image","https://img-blog.csdnimg.cn/7a621873074f47aabadf1c06459f42d7.png?x-oss-process=image","https://img-blog.csdnimg.cn/e881e522d9294517917e1ade9b9feae6.png?x-oss-process=image","https://img-blog.csdnimg.cn/812979b2bd1a480381b18b140da5d6dd.png?x-oss-process=image","https://img-blog.csdnimg.cn/e58917e4210b4ab192f683b6262c9343.png?x-oss-process=image","https://img-blog.csdnimg.cn/0dd3d0d11ed240999af9a1adac513b5a.png?x-oss-process=image","https://img-blog.csdnimg.cn/dee3b4cf6fe14734ab8599e2373a19b2.png#pic_center","https://img-blog.csdnimg.cn/4af68efd200543a6811d606d2be9a8cd.png#pic_center","https://img-blog.csdnimg.cn/403a8237a5e443e2b10a5941b0f17728.png#pic_center","https://img-blog.csdnimg.cn/4712938b94cb4261ad945d4b62378ffd.png#pic_center","https://img-blog.csdnimg.cn/d6d12ebb00074e7dad8492f9e2c2123d.png?x-oss-process=image"],"content":"<h1 id=\"Java 网络编程\"><a href=\"#Java 网络编程\" class=\"headerlink\" title=\"Java 网络编程\"></a>Java 网络编程 </h1><p> 参考视频:BV1LJ411z7vY</p>\n<p>CSDN:<a href=\"https://blog.csdn.net/INFINITE_WAR/article/details/122516970\">https://blog.csdn.net/INFINITE_WAR/article/details/122516970</a></p>\n<p>网络内容大体已经学过。这里重点记录编程实现。</p>\n<h1 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.UnknownHostException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 测试 IP</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestInteAddress</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            InetAddress inetAddress1=InetAddress.getByName(<span class=\"string\">&quot;127.0.0.1&quot;</span>);</span><br><span class=\"line\">            InetAddress inetAddress2=InetAddress.getLocalHost();</span><br><span class=\"line\">            InetAddress inetAddress3=InetAddress.getByName(<span class=\"string\">&quot;www.bilibili.com&quot;</span>);</span><br><span class=\"line\">            System.out.println(inetAddress1);</span><br><span class=\"line\">            System.out.println(inetAddress2);</span><br><span class=\"line\">            System.out.println(inetAddress3);</span><br><span class=\"line\"></span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;=================&quot;</span>);</span><br><span class=\"line\">            System.out.println(inetAddress3.getAddress());</span><br><span class=\"line\">            System.out.println(inetAddress3.getCanonicalHostName());  <span class=\"comment\">// 获取规范命名</span></span><br><span class=\"line\">            System.out.println(inetAddress3.getHostAddress());</span><br><span class=\"line\">            System.out.println(inetAddress3.getHostName());</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (UnknownHostException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/c8ebcb0fe73e476ebbc27e551cba69ef.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"端口\"><a href=\"# 端口\" class=\"headerlink\" title=\"端口\"></a>端口 </h1><p> 端口表示计算机上的一个程序的进程：</p>\n<ul>\n<li>不同的进程有不同的端口号</li>\n<li>端口号范围：0~65535</li>\n<li>TCP 和 UDP 各有 65535 个端口号。TCP 的 x 端口与 UDP 的 x 端口不冲突。</li>\n</ul>\n<p>端口分类:</p>\n<ul>\n<li>公有端口 0~1023。如 HTTP:30，HTTPS:443，FTP:21，Telnet:23</li>\n<li>程序注册端口:1024~49151, 用于分配用户或程序。如 Tomcat:8080，MySQL:3306 ，Oracle:1521</li>\n<li>动态、私有：49125~65535</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat -ano  <span class=\"comment\"># 查看所有的端口</span></span><br><span class=\"line\">netstat -ano|findstr <span class=\"string\">&quot;5900&quot;</span>  <span class=\"comment\"># 筛选查询信息，只显示 5900 端口号信息</span></span><br><span class=\"line\">tasklist|findstr <span class=\"string\">&quot;8696&quot;</span> <span class=\"comment\"># 查看指定端口的进程</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestInetSocketAddress</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        InetSocketAddress inetSocketAddress1=<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">&quot;127.0.0.1&quot;</span>,<span class=\"number\">8080</span>);  <span class=\"comment\">//8080 为端口号</span></span><br><span class=\"line\">        InetSocketAddress inetSocketAddress2=<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">&quot;localhost&quot;</span>,<span class=\"number\">8080</span>);</span><br><span class=\"line\">        System.out.println(inetSocketAddress1);</span><br><span class=\"line\">        System.out.println(inetSocketAddress2);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(inetSocketAddress1.getAddress());</span><br><span class=\"line\">        System.out.println(inetSocketAddress1.getHostName());</span><br><span class=\"line\">        System.out.println(inetSocketAddress1.getPort());<span class=\"comment\">// 获取端口号</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/7a621873074f47aabadf1c06459f42d7.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"TCP\"><a href=\"#TCP\" class=\"headerlink\" title=\"TCP\"></a>TCP</h1><h2 id=\"简易文本传输\"><a href=\"# 简易文本传输\" class=\"headerlink\" title=\"简易文本传输\"></a>简易文本传输 </h2><p> 客户端</p>\n<ol>\n<li>连接服务器 Socket</li>\n<li>发送消息</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.OutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.UnknownHostException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.charset.StandardCharsets;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">*  客户端</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TcpCilentDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Socket socket=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        OutputStream os=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//1. 要获取服务器的地址、端口号</span></span><br><span class=\"line\">            InetAddress serverIP=InetAddress.getByName(<span class=\"string\">&quot;127.0.0.1&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> port=<span class=\"number\">9999</span>;</span><br><span class=\"line\">            <span class=\"comment\">//2. 创建一个 socket 连接</span></span><br><span class=\"line\">            socket=<span class=\"keyword\">new</span> Socket(serverIP,port);</span><br><span class=\"line\">            <span class=\"comment\">// 发送消息  IO 流</span></span><br><span class=\"line\">            os=socket.getOutputStream();</span><br><span class=\"line\">            os.write(<span class=\"string\">&quot; 测试测试测试测试测试测试 &quot;</span>.getBytes());</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (os!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;os.close();&#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (socket!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;socket.close();&#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p>服务器</p>\n<ol>\n<li>建立服务的端口 ServerSocket</li>\n<li>通过 accept()方法等待用户连接</li>\n<li>接收用户的消息</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.ByteArrayOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">*  服务器端</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TcpServerDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        ServerSocket serverSocket=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Socket socket=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        InputStream is=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ByteArrayOutputStream baos=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//1. 设置地址</span></span><br><span class=\"line\">            serverSocket=<span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9999</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">//2. 等待客户端连接</span></span><br><span class=\"line\">                socket=serverSocket.accept();</span><br><span class=\"line\">                <span class=\"comment\">//3. 读取客户端传输的信息。使用管道流</span></span><br><span class=\"line\">                is=socket.getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                baos=<span class=\"keyword\">new</span> ByteArrayOutputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">byte</span>[] buffer=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">                <span class=\"keyword\">int</span> len;</span><br><span class=\"line\">                <span class=\"keyword\">while</span>((len=is.read(buffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">                    baos.write(buffer,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(baos.toString());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 按栈的顺序关闭所有资源</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (baos!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;baos.close();&#125;</span><br><span class=\"line\">                <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (is!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;is.close();&#125;</span><br><span class=\"line\">                <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (socket!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;socket.close();&#125;</span><br><span class=\"line\">                <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (serverSocket!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;serverSocket.close();&#125;</span><br><span class=\"line\">                <span class=\"keyword\">catch</span> (IOException e) &#123;e.printStackTrace();&#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/e881e522d9294517917e1ade9b9feae6.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"文件传输\"><a href=\"# 文件传输\" class=\"headerlink\" title=\"文件传输\"></a>文件传输 </h2><p> 客户端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TcpCilentDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//1. 创建一个 scoket 连接</span></span><br><span class=\"line\">        Socket socket=<span class=\"keyword\">new</span> Socket(InetAddress.getByName(<span class=\"string\">&quot;127.0.0.1&quot;</span>),<span class=\"number\">9000</span>);</span><br><span class=\"line\">        <span class=\"comment\">//2. 创建一个输出流</span></span><br><span class=\"line\">        OutputStream os=socket.getOutputStream();</span><br><span class=\"line\">        <span class=\"comment\">//3. 读文件</span></span><br><span class=\"line\">        FileInputStream fis=<span class=\"keyword\">new</span> FileInputStream(<span class=\"keyword\">new</span> File(<span class=\"string\">&quot;C:\\\\Users\\\\96955\\\\Desktop\\\\work.png&quot;</span>));</span><br><span class=\"line\">        <span class=\"comment\">//4. 写文件</span></span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] buffer=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>((len=fis.read(buffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            os.write(buffer,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通知服务器上传完毕</span></span><br><span class=\"line\">        socket.shutdownOutput();</span><br><span class=\"line\">        <span class=\"comment\">// 确定服务器接收完毕。再断开连接</span></span><br><span class=\"line\">        InputStream is=socket.getInputStream();</span><br><span class=\"line\">        ByteArrayOutputStream baos=<span class=\"keyword\">new</span> ByteArrayOutputStream();</span><br><span class=\"line\">        <span class=\"keyword\">while</span>((len=is.read(buffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            baos.write(buffer,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(baos.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//5. 关闭资源</span></span><br><span class=\"line\">        baos.close();</span><br><span class=\"line\">        is.close();</span><br><span class=\"line\">        fis.close();</span><br><span class=\"line\">        os.close();</span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p>服务器端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.charset.StandardCharsets;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TcpServerDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//1. 创建服务</span></span><br><span class=\"line\">        ServerSocket serverSocket=<span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9000</span>);</span><br><span class=\"line\">        <span class=\"comment\">//2. 监听客户端的连接</span></span><br><span class=\"line\">        Socket socket=serverSocket.accept();  <span class=\"comment\">// 阻塞式监听，会已知等待客户端的连接</span></span><br><span class=\"line\">        <span class=\"comment\">//3. 获取输入流</span></span><br><span class=\"line\">        InputStream is=socket.getInputStream();</span><br><span class=\"line\">        <span class=\"comment\">//4. 文件输出</span></span><br><span class=\"line\">        FileOutputStream fos=<span class=\"keyword\">new</span> FileOutputStream(<span class=\"keyword\">new</span> File(<span class=\"string\">&quot;C:\\\\Users\\\\96955\\\\Desktop\\\\tempblog\\\\receive.png&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] buffer=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>((len=is.read(buffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            fos.write(buffer,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 通知用户端接收完毕</span></span><br><span class=\"line\">        OutputStream os=socket.getOutputStream();</span><br><span class=\"line\">        os.write(<span class=\"string\">&quot; 接收完毕 &quot;</span>.getBytes());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//5. 关闭页面</span></span><br><span class=\"line\">        fos.close();</span><br><span class=\"line\">        is.close();</span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">        serverSocket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"初识 Tomcat\"><a href=\"# 初识 Tomcat\" class=\"headerlink\" title=\"初识 Tomcat\"></a>初识 Tomcat</h1><p>源码获取:<a href=\"https://github.com/apache/tomcat\">https://github.com/apache/tomcat</a></p>\n<p>可参考博客<a href=\"https://blog.csdn.net/o_o_gl/article/details/79662995\">https://blog.csdn.net/o_o_gl/article/details/79662995</a></p>\n<p><img src=\"https://img-blog.csdnimg.cn/812979b2bd1a480381b18b140da5d6dd.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"https://img-blog.csdnimg.cn/e58917e4210b4ab192f683b6262c9343.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"UDP\"><a href=\"#UDP\" class=\"headerlink\" title=\"UDP\"></a>UDP</h1><p>发短信: 不用建立连接，但需要知道对方的地址</p>\n<h2 id=\"简易消息发送\"><a href=\"# 简易消息发送\" class=\"headerlink\" title=\"简易消息发送\"></a>简易消息发送 </h2><p> 客户端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.charset.StandardCharsets;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UDPClientDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//1. 建立一个 Socket</span></span><br><span class=\"line\">        DatagramSocket socket=<span class=\"keyword\">new</span> DatagramSocket();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//2. 建个包</span></span><br><span class=\"line\">        String msg=<span class=\"string\">&quot;hello&quot;</span>;</span><br><span class=\"line\">        InetAddress localHost=InetAddress.getByName(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> port=<span class=\"number\">9000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 传入参数: 数据本身，数据的长度、起始位置，发送给谁</span></span><br><span class=\"line\">        DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(msg.getBytes(),<span class=\"number\">0</span>,msg.getBytes().length,localHost,port);</span><br><span class=\"line\">        <span class=\"comment\">//3. 发送包</span></span><br><span class=\"line\">        socket.send(packet);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//4. 关闭连接</span></span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>服务器端(也可以是客户端)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UDPServerDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span><span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开放端口</span></span><br><span class=\"line\">        DatagramSocket socket=<span class=\"keyword\">new</span> DatagramSocket(<span class=\"number\">9000</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 接收数据包</span></span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] buffer=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(buffer,<span class=\"number\">0</span>,buffer.length);</span><br><span class=\"line\">        socket.receive(packet); <span class=\"comment\">// 阻塞接收</span></span><br><span class=\"line\">        System.out.println(packet.getAddress());</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">new</span> String(packet.getData(),<span class=\"number\">0</span>,packet.getLength()));</span><br><span class=\"line\">        <span class=\"comment\">// 关闭连接</span></span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/0dd3d0d11ed240999af9a1adac513b5a.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"实现聊天\"><a href=\"# 实现聊天\" class=\"headerlink\" title=\"实现聊天\"></a>实现聊天 </h2><p> 发送端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.charset.StandardCharsets;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UDPSenderDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception</span>&#123;</span><br><span class=\"line\">        DatagramSocket socket=<span class=\"keyword\">new</span> DatagramSocket(<span class=\"number\">8888</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 数据输入</span></span><br><span class=\"line\">        BufferedReader reader=<span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> InputStreamReader(System.in));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            String data=reader.readLine();</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] datas=data.getBytes();</span><br><span class=\"line\">            DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(datas,<span class=\"number\">0</span>,datas.length,<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">&quot;localhost&quot;</span>,<span class=\"number\">6666</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">            socket.send(packet);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(data.equals(<span class=\"string\">&quot;bye&quot;</span>))&#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>接收端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UDPReceiverDemo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span><span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        DatagramSocket socket=<span class=\"keyword\">new</span> DatagramSocket(<span class=\"number\">6666</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 准备接收数据包</span></span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] container=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(container,<span class=\"number\">0</span>,container.length);</span><br><span class=\"line\">            socket.receive(packet);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 断开连接</span></span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] data=packet.getData();</span><br><span class=\"line\">            String receiveData=<span class=\"keyword\">new</span> String(data,<span class=\"number\">0</span>, packet.getLength());</span><br><span class=\"line\">            System.out.println(receiveData);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(receiveData.equals(<span class=\"string\">&quot;bye&quot;</span>))&#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/dee3b4cf6fe14734ab8599e2373a19b2.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"https://img-blog.csdnimg.cn/4af68efd200543a6811d606d2be9a8cd.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"多线程在线咨询\"><a href=\"# 多线程在线咨询\" class=\"headerlink\" title=\"多线程在线咨询\"></a>多线程在线咨询 </h2><p> 先实现发送和接收功能，分别封装成两个类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 消息发送功能</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TalkSend</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span>&#123;</span><br><span class=\"line\">    DatagramSocket socket=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">    BufferedReader reader=<span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span>  <span class=\"keyword\">int</span> fromPort;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String toIP;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> toPort;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TalkSend</span><span class=\"params\">(<span class=\"keyword\">int</span> fromPort, String toIP, <span class=\"keyword\">int</span> toPort)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.fromPort = fromPort;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.toIP = toIP;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.toPort = toPort;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            socket=<span class=\"keyword\">new</span> DatagramSocket(fromPort);</span><br><span class=\"line\">            reader=<span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> InputStreamReader(System.in));</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                String data=reader.readLine();</span><br><span class=\"line\">                <span class=\"keyword\">byte</span>[] datas=data.getBytes();</span><br><span class=\"line\">                DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(datas,<span class=\"number\">0</span>,datas.length,<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"keyword\">this</span>.toIP,<span class=\"keyword\">this</span>.toPort));</span><br><span class=\"line\"></span><br><span class=\"line\">                socket.send(packet);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(data.equals(<span class=\"string\">&quot;bye&quot;</span>))&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramPacket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.DatagramSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.SocketException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 消息接收功能</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TalkReceive</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span>&#123;</span><br><span class=\"line\">    DatagramSocket socket=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> port;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String msgFrom;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TalkReceive</span><span class=\"params\">(<span class=\"keyword\">int</span> port,String msgFrom)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.port = port;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.msgFrom=msgFrom;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            socket=<span class=\"keyword\">new</span> DatagramSocket(port);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SocketException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 准备接收数据包</span></span><br><span class=\"line\">                <span class=\"keyword\">byte</span>[] container=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">                DatagramPacket packet=<span class=\"keyword\">new</span> DatagramPacket(container,<span class=\"number\">0</span>,container.length);</span><br><span class=\"line\">                socket.receive(packet);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 断开连接</span></span><br><span class=\"line\">                <span class=\"keyword\">byte</span>[] data=packet.getData();</span><br><span class=\"line\">                String receiveData=<span class=\"keyword\">new</span> String(data,<span class=\"number\">0</span>, packet.getLength());</span><br><span class=\"line\">                System.out.println(msgFrom+<span class=\"string\">&quot;:&quot;</span>+receiveData);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span>(receiveData.equals(<span class=\"string\">&quot;bye&quot;</span>))&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        socket.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<p>两个功能作为两个线程写入用户类</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TalkStudent</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开启两个线程</span></span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> TalkSend(<span class=\"number\">7777</span>,<span class=\"string\">&quot;localhost&quot;</span>,<span class=\"number\">9999</span>)).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> TalkReceive(<span class=\"number\">8888</span>,<span class=\"string\">&quot; 老师 &quot;</span>)).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TalkTeacher</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> TalkSend(<span class=\"number\">5555</span>,<span class=\"string\">&quot;localhost&quot;</span>,<span class=\"number\">8888</span>)).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> TalkReceive(<span class=\"number\">9999</span>,<span class=\"string\">&quot; 学生 &quot;</span>)).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img src=\"https://img-blog.csdnimg.cn/403a8237a5e443e2b10a5941b0f17728.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"https://img-blog.csdnimg.cn/4712938b94cb4261ad945d4b62378ffd.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> NetTest;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.net.ssl.HttpsURLConnection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.HttpURLConnection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">URLDown</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//1. 下载地址</span></span><br><span class=\"line\">        URL url=<span class=\"keyword\">new</span> URL(<span class=\"string\">&quot;https://i0.hdslb.com/bfs/videoshot/67730043.jpg&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//2. 连接到该网页</span></span><br><span class=\"line\">        HttpURLConnection urlConnection=(HttpsURLConnection) url.openConnection();</span><br><span class=\"line\">        InputStream inputStream=urlConnection.getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">        FileOutputStream fos=<span class=\"keyword\">new</span> FileOutputStream(<span class=\"string\">&quot;11.jpg&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] buffer=<span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> len;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>((len=inputStream.read(buffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            fos.write(buffer,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        fos.close();</span><br><span class=\"line\">        inputStream.close();</span><br><span class=\"line\">        urlConnection.disconnect();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://img-blog.csdnimg.cn/d6d12ebb00074e7dad8492f9e2c2123d.png?x-oss-process=image\" alt=\"在这里插入图片描述\"></p>\n","url":"/posts/9017/","min2read":11,"word4post":"2.1k","prev_post":{"title":"Java 多线程基础","url":"/posts/24112/"},"next_post":{"title":"JavaGUI 基础","url":"/posts/47384/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"Java 网络编程\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">Java 网络编程 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"IP\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\">IP</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"端口\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\">端口 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"TCP\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\">TCP</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"简易文本传输\" href = \"#\"><span class=\"toc-number\">4.1.</span> <span class=\"toc-text\">简易文本传输 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"文件传输\" href = \"#\"><span class=\"toc-number\">4.2.</span> <span class=\"toc-text\">文件传输 </span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"初识 Tomcat\" href = \"#\"><span class=\"toc-number\">5.</span> <span class=\"toc-text\">初识 Tomcat</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"UDP\" href = \"#\"><span class=\"toc-number\">6.</span> <span class=\"toc-text\">UDP</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"简易消息发送\" href = \"#\"><span class=\"toc-number\">6.1.</span> <span class=\"toc-text\">简易消息发送 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"实现聊天\" href = \"#\"><span class=\"toc-number\">6.2.</span> <span class=\"toc-text\">实现聊天 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"多线程在线咨询\" href = \"#\"><span class=\"toc-number\">6.3.</span> <span class=\"toc-text\">多线程在线咨询 </span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"URL\" href = \"#\"><span class=\"toc-number\">7.</span> <span class=\"toc-text\">URL</span></a></li></ol>","categories":[],"tags":[{"name":"JavaSE","path":"api/tags/JavaSE.json","url":"/tags/JavaSE/"}]}