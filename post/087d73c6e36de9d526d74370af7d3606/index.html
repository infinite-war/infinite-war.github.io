<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《C 和指针》阅读笔记 | infinite-war の BLOG</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png">
    <meta name="description" content="《C和指针》 Kenneth著CSDN:https://blog.csdn.net/INFINITE_WAR/article/details/121294114# 1、快速上手预处理指令：```c#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;stri ...">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#ffffff">
    <meta name="google-site-verification" content="DR-3xvCA7YBP7TIeg7__j5lxaniGh2pzocrfywyn8o0">
    <meta name="baidu-site-verification" content="zQef3H7nga">
    
    <link rel="preload" href="./assets/css/0.styles.ab82154a.css" as="style"><link rel="preload" href="./assets/js/app.152d2abe.js" as="script"><link rel="preload" href="./assets/js/5.45f84343.js" as="script"><link rel="preload" href="./assets/js/35.4683a28e.js" as="script"><link rel="preload" href="./assets/js/10.e02dcdbc.js" as="script"><link rel="preload" href="./assets/js/7.6b3198e2.js" as="script"><link rel="prefetch" href="./assets/js/11.56ca4439.js"><link rel="prefetch" href="./assets/js/12.e7263128.js"><link rel="prefetch" href="./assets/js/13.6aa36547.js"><link rel="prefetch" href="./assets/js/14.17d1cb9e.js"><link rel="prefetch" href="./assets/js/15.74bd3f85.js"><link rel="prefetch" href="./assets/js/16.6cb58eaa.js"><link rel="prefetch" href="./assets/js/17.a2418203.js"><link rel="prefetch" href="./assets/js/18.0ce3e861.js"><link rel="prefetch" href="./assets/js/19.d38b8843.js"><link rel="prefetch" href="./assets/js/20.c056825b.js"><link rel="prefetch" href="./assets/js/21.55f4c10c.js"><link rel="prefetch" href="./assets/js/22.04dd41d1.js"><link rel="prefetch" href="./assets/js/23.1c3c301b.js"><link rel="prefetch" href="./assets/js/24.cd8025ea.js"><link rel="prefetch" href="./assets/js/25.ba1b9f93.js"><link rel="prefetch" href="./assets/js/26.6682378c.js"><link rel="prefetch" href="./assets/js/27.b37436f6.js"><link rel="prefetch" href="./assets/js/28.a5979a1e.js"><link rel="prefetch" href="./assets/js/29.b5265440.js"><link rel="prefetch" href="./assets/js/3.9a5ec62e.js"><link rel="prefetch" href="./assets/js/30.3e2cac84.js"><link rel="prefetch" href="./assets/js/31.6c7014c4.js"><link rel="prefetch" href="./assets/js/32.3f06e55b.js"><link rel="prefetch" href="./assets/js/33.b1d68207.js"><link rel="prefetch" href="./assets/js/34.76d77190.js"><link rel="prefetch" href="./assets/js/36.9cf1d52f.js"><link rel="prefetch" href="./assets/js/37.3f6975cf.js"><link rel="prefetch" href="./assets/js/38.f88fc48d.js"><link rel="prefetch" href="./assets/js/39.f219d981.js"><link rel="prefetch" href="./assets/js/4.dfb684c6.js"><link rel="prefetch" href="./assets/js/40.ff3307ef.js"><link rel="prefetch" href="./assets/js/41.50e1e4a2.js"><link rel="prefetch" href="./assets/js/42.375a133d.js"><link rel="prefetch" href="./assets/js/43.a125d1e0.js"><link rel="prefetch" href="./assets/js/44.54249944.js"><link rel="prefetch" href="./assets/js/45.17c8ad02.js"><link rel="prefetch" href="./assets/js/46.1e1ff28c.js"><link rel="prefetch" href="./assets/js/47.805830d4.js"><link rel="prefetch" href="./assets/js/48.edec476d.js"><link rel="prefetch" href="./assets/js/49.44e0d779.js"><link rel="prefetch" href="./assets/js/50.f607e4f6.js"><link rel="prefetch" href="./assets/js/6.a2b9c671.js"><link rel="prefetch" href="./assets/js/8.0d136561.js"><link rel="prefetch" href="./assets/js/9.11f39998.js"><link rel="prefetch" href="./assets/js/vuejs-paginate.b3baa744.js">
    <link rel="stylesheet" href="./assets/css/0.styles.ab82154a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="GlobalLayout skin-jshine" data-v-5f6ffb84><!----> <div class="Launch" data-v-2d5332d6 data-v-5f6ffb84><div class="avatar" style="background-image:url('/assets/img/avatar.png');" data-v-2d5332d6></div></div> <div class="Spinner " data-v-4a1f0306 data-v-5f6ffb84></div> <div class="Header" data-v-a012f084 data-v-5f6ffb84><div class="ext " data-v-a012f084><i class="fas fa-cube" data-v-a012f084></i></div> <div class="sitename" data-v-a012f084><em><span>infinite-war's</span></em><strong><span>BLOG</span></strong></div> <div class="ext " data-v-a012f084><i class="fas fa-search" data-v-a012f084></i></div></div> <div class="Goingto" data-v-106a8802 data-v-5f6ffb84><div class="top" data-v-106a8802><i class="fas fa-arrow-up" data-v-106a8802></i></div> <div class="bottom" data-v-106a8802><i class="fas fa-arrow-down" data-v-106a8802></i></div></div> <div class="Addin" data-v-68b01994 data-v-5f6ffb84><div class="top " data-v-68b01994><i class="fas fa-ad" data-v-68b01994></i></div> <div class="bottom " data-v-68b01994><i class="fas fa-qrcode" data-v-68b01994></i></div> <!----></div> <!----> <div class="frame" data-v-5f6ffb84><div class="main" data-v-5f6ffb84><div class="drawer" data-v-5f6ffb84><div class="Drawer" data-v-68407f5a data-v-5f6ffb84><div class="Brand card" data-v-bb741bc0 data-v-68407f5a><div class="caption ifSmallest" data-v-bb741bc0><span class="icon" data-v-bb741bc0><i class="fas fa-id-card fa-fw" data-v-bb741bc0></i></span> <span data-v-bb741bc0>CARD</span></div> <div class="avatar" style="background-image:url('/assets/img/brand.png');" data-v-bb741bc0></div> <div class="inner" data-v-bb741bc0><div class="author" data-v-bb741bc0>Mitchell</div> <div class="signature" data-v-bb741bc0>issue, func, flow, std, solve</div> <div class="counter" data-v-bb741bc0><span title="Count of Posts" data-v-bb741bc0><i class="fas fa-archive fa-fw" data-v-bb741bc0></i>
        30 </span>|
      <span title="Count of Categories" data-v-bb741bc0><i class="fas fa-folder-open fa-fw" data-v-bb741bc0></i>
        15 </span>|
      <span title="Count of Tags" data-v-bb741bc0><i class="fas fa-tags fa-fw" data-v-bb741bc0></i>
        22
      </span></div> <div class="contact" data-v-bb741bc0><a target="_blank" href="https://github.com/infinite-war" title="infinite-war" data-v-bb741bc0><i class="fab fa-github fa-fw"></i></a><a target="_blank" href="mailto://969557028@qq.com" title="969557028@qq.com" data-v-bb741bc0><i class="fas fa-envelope fa-fw"></i></a><a target="_blank" href="tencent://Message/?uin=969557028" title="969557028" data-v-bb741bc0><i class="fab fa-qq fa-fw"></i></a></div></div> <div class="minimize ifSmallest" data-v-bb741bc0></div></div> <div class="Menu" data-v-098eaa92 data-v-68407f5a><div class="card" data-v-098eaa92><div class="caption" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-sitemap fa-fw"></i></span> <span data-v-098eaa92>MENU</span></div> <div class="inner" data-v-098eaa92><a href="/" class="router-link-active" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-home fa-fw"></i></span> <span data-v-098eaa92>Home</span></a><a href="/archive/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-archive fa-fw"></i></span> <span data-v-098eaa92>Archive</span></a><a href="/codes/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-box fa-fw"></i></span> <span data-v-098eaa92>Code Library</span></a><a href="/icons/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-icons fa-fw"></i></span> <span data-v-098eaa92>Icon Font Library</span></a><a href="/records/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-edit fa-fw"></i></span> <span data-v-098eaa92>Records</span></a><a href="/gallery/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-images fa-fw"></i></span> <span data-v-098eaa92>Gallery</span></a><a href="/resume/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-paper-plane fa-fw"></i></span> <span data-v-098eaa92>Resume Tips</span></a><a href="/letter/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-file-contract fa-fw"></i></span> <span data-v-098eaa92>Cover Letter Tips</span></a><a href="/about/" data-v-098eaa92><span class="icon" data-v-098eaa92><i class="fas fa-user fa-fw"></i></span> <span data-v-098eaa92>About</span></a></div> <div class="minimize" data-v-098eaa92></div></div></div> <div class="Skin card" data-v-5752a7b7 data-v-68407f5a><div class="caption" data-v-5752a7b7><span class="icon" data-v-5752a7b7><i class="fas fa-tshirt fa-fw" data-v-5752a7b7></i></span> <span data-v-5752a7b7>SKIN</span></div> <div class="inner" data-v-5752a7b7><div title="Default" class="color " style="background:#696969;" data-v-5752a7b7></div><div title="White &amp; Black" class="color " style="background:linear-gradient(120deg, #666666, #999999, #333333);" data-v-5752a7b7></div><div title="JShine" class="color active" style="background:linear-gradient(120deg, #ff3300, #cc66ff, #00ccff);" data-v-5752a7b7></div><div title="Memariani" class="color " style="background:linear-gradient(120deg, #cc6699, #6666cc, #33cccc);" data-v-5752a7b7></div></div> <div class="minimize" data-v-5752a7b7></div></div> <div class="Settings card" data-v-8ef0d620 data-v-68407f5a><div class="caption" data-v-8ef0d620><span class="icon" data-v-8ef0d620><i class="fas fa-cog fa-fw" data-v-8ef0d620></i></span> <span data-v-8ef0d620>SETTINGS</span></div> <div class="inner" data-v-8ef0d620><div class=" " data-v-8ef0d620><span class="icon" data-v-8ef0d620><i class="fas fa-adjust fa-fw"></i></span> <span data-v-8ef0d620>Night Shift</span> <div class="switch" data-v-8ef0d620></div></div><div class=" " data-v-8ef0d620><span class="icon" data-v-8ef0d620><i class="fas fa-video-slash fa-fw"></i></span> <span data-v-8ef0d620>Disable Canvas</span> <div class="switch" data-v-8ef0d620></div></div><div class="active " data-v-8ef0d620><span class="icon" data-v-8ef0d620><i class="fas fa-globe-asia fa-fw"></i></span> <span data-v-8ef0d620>简体中文</span> <div class="switch" data-v-8ef0d620></div></div></div> <div class="minimize" data-v-8ef0d620></div></div></div></div> <div class="center " data-v-5f6ffb84><div class="Translate card" data-v-bbd4da56 data-v-5f6ffb84><div class="bar " data-v-bbd4da56><div title="Highlight words to translate - Supported by Baidu Translation API" class="sq highlight" data-v-bbd4da56><i class="fas fa-highlighter" data-v-bbd4da56></i></div> <div class="locales" data-v-bbd4da56><div data-v-bbd4da56>中文</div> <span data-v-bbd4da56>|</span> <div data-v-bbd4da56>English</div> <span data-v-bbd4da56>|</span> <div data-v-bbd4da56>日本語</div> <!----></div> <div title="Click to copy highlighted content above translation bar" class="sq copy" data-v-bbd4da56><i class="fas fa-copy" data-v-bbd4da56></i></div></div> <!----></div> <div data-v-5f6ffb84><div class="Post" data-v-55aed3a6 data-v-5f6ffb84><div class="Article card fix " data-v-3caaac61 data-v-55aed3a6><div class="caption" data-v-3caaac61><span class="icon" data-v-3caaac61><i class="fas fa-file fa-fw" data-v-3caaac61></i></span> <span data-v-3caaac61>PAGE CONTENT</span></div> <div class="inner" data-v-3caaac61><div class="meta  " data-v-3caaac61><div class="meta-title" data-v-3caaac61>《C 和指针》阅读笔记</div> <div class="meta-info" data-v-3caaac61><div class="info-date" data-v-3caaac61><i class="fas fa-calendar-alt fa-fw" data-v-3caaac61></i>
          2021-11-12
        </div> <div class="info-updated" data-v-3caaac61><i class="fas fa-calendar-check fa-fw" data-v-3caaac61></i>
          2021-11-12
        </div> <div class="info-categories" data-v-3caaac61><i class="fas fa-folder-open fa-fw" data-v-3caaac61></i> <span data-v-3caaac61><!----> <a href="/category/语言/" data-v-3caaac61>语言</a></span></div> <div class="info-wordcount" data-v-3caaac61><i class="fas fa-file-word fa-fw" data-v-3caaac61></i>
          21.9k
        </div> <div class="info-wordcount" data-v-3caaac61><i class="fas fa-stopwatch fa-fw" data-v-3caaac61></i>
          163 min.
        </div></div></div> <div class="markdown-body content__default" data-v-3caaac61><p>《C和指针》 Kenneth著</p> <p>CSDN:https://blog.csdn.net/INFINITE_WAR/article/details/121294114</p> <h1 id="_1、快速上手"><a href="#_1、快速上手" class="header-anchor">#</a> 1、快速上手</h1> <p>预处理指令：</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_COLS</span> <span class="token expression"><span class="token number">20</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_INPUT</span> <span class="token expression"><span class="token number">1000</span></span></span>
</code></pre></div><p>这些指令由预处理器解释，预处理器读入源代码，根据预处理指令对其进行<u>修改</u>，然后把修改过的源代码递交给编译器。</p> <p>用#define定义的常量一般用大写加以区分，且该变量不能被赋值。</p> <p>当预处理语句过多时，可以把它们打包到一个自定义头文件中，然后直接引用该头文件即可，这样还能避免由于同一个声明的多份拷贝而导致的维护性问题。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
*  读取、处理和打印剩余的输入行
*/</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">gets</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Original input : $s\n&quot;</span><span class="token punctuation">,</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rearrange</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> input<span class="token punctuation">,</span> n_columns<span class="token punctuation">,</span>columns<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Rearranged line: %s\n&quot;</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要多在代码中写进必要的注释，以此来解释清楚什么地方的代码是什么功能，这样过一段时间后别人(或自己)重看一遍这部分代码会很容易理解，更有利于维护。同时，更新代码时也要注意相关注释的更新。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
* 读取列标号，如果超出规定范围则不予理会
*/</span>
<span class="token keyword">int</span> <span class="token function">read_column_numbers</span><span class="token punctuation">(</span><span class="token keyword">int</span> columns<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>声明的数组不用附带长度，这种特性允许函数操纵任意长度的一维数组， 缺点就是不能获取数组的长度。</p> <div class="language-c extra-class"><pre class="language-c"><code>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>ch<span class="token operator">!=</span><span class="token constant">EOF</span> <span class="token operator">&amp;&amp;</span> ch<span class="token operator">!=</span><span class="token char">'\n'</span><span class="token punctuation">)</span>   <span class="token comment">//EOF 本质上是个整数值</span>
    ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这块代码用于一个个读取字符直至到达文件末尾（或者读到换行符）。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
*  处理输入行，将指定列的字符连接在一起，输出行以NULL结尾
*/</span>
<span class="token keyword">void</span> <span class="token function">rearrange</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>output<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>input<span class="token punctuation">,</span>
              <span class="token keyword">int</span> n_columns<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token keyword">const</span> columns<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>数组本质上就是指针，因此传入的参数不是数组的备份而是指针，也就是说，在函数内对数组参数的修改会影响函数外部的实际数组。为了避免修改数组，可以将参数声明为 const 。</p> <h2 id="警告与总结"><a href="#警告与总结" class="header-anchor">#</a> 警告与总结</h2> <p>1.在scanf函数的标量参数前未添加&amp;字符。</p> <p>2.机械的把printf函数的格式代码照搬于scanf函数。</p> <p>3.在应该使用&amp;&amp;操作符的地方误用了&amp;操作符。</p> <p>4.误用=操作符而不是==操作符来测试相等性。</p> <h2 id="编程提示的总结"><a href="#编程提示的总结" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.使用#include指令避免重复声明</p> <p>2.使用#define指令给常量值取名。</p> <p>3.在#include文件中放置函数原型。</p> <p>4.在使用下标前先检查它们的值。</p> <p>5.在while或if表达式中蕴含赋值操作。</p> <p>6.如何编写一个空循环体。</p> <p>7.始终要进行检查，去日报数组不越界。</p> <h1 id="_2、基本概念"><a href="#_2、基本概念" class="header-anchor">#</a> 2、基本概念</h1> <h2 id="_2-1-环境"><a href="#_2-1-环境" class="header-anchor">#</a> 2.1 环境</h2> <h3 id="_2-1-1-翻译环境"><a href="#_2-1-1-翻译环境" class="header-anchor">#</a> 2.1.1 翻译环境</h3> <p>翻译阶段，一个(或多个)源文件(Source code)通过编译(Complier)过程分别转换为目标代码(Object code)。然后，这些目标代码由链接器(linker)捆绑在一起，形成一个可执行(executable)程序。</p> <p>编译过程：</p> <p>​	1.预处理器处理。预处理在源代码上执行一些文本操作。如：用实际值代替#define等命令，读入#include包含的文件。</p> <p>​	2.解析，判断语句的意思。随后产生目标代码(机器指令的初步形式，用于实现程序的语句)。   如果我们在编译程序的命令行中假如了要求进行优化的选项，优化器(optimizer)可以进一步处理目标代码，使其效率更高(优化过程更耗时间)。
<img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/fa5282ca3d5a4ee08e03a2b4a024ded8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_18,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>下面以UNIX为例进行编译和链接</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//1、编译并连接一个完全包含于一个源文件的C程序</span>
cc program<span class="token punctuation">.</span>c
<span class="token comment">//会产生一个a.cout可执行程序。中间会产生program.o目标文件,不</span>
<span class="token comment">//过它在连接过程完成后会被删除。</span>

<span class="token comment">//2、编译并链接几个C源文件</span>
cc main<span class="token punctuation">.</span>c sort<span class="token punctuation">.</span>c lookup<span class="token punctuation">.</span>c
<span class="token comment">//当编译的源文件超过一个时，目标文件不会被删除</span>

<span class="token comment">//3、编译一个C源文件，并把它和现存的目标文件链接在一起</span>
cc main<span class="token punctuation">.</span>o lookup<span class="token punctuation">.</span>o sort<span class="token punctuation">.</span>c

<span class="token comment">//4、编译单个C源文件，并产生一个目标文件，以后再进行链接</span>
cc <span class="token operator">-</span>c program<span class="token punctuation">.</span>c

<span class="token comment">//5、编译几个C源文件，并为每个文件产生一个目标文件</span>
cc <span class="token operator">-</span>c main<span class="token punctuation">.</span>c sort<span class="token punctuation">.</span>c lookup<span class="token punctuation">.</span>c

<span class="token comment">//6、链接几个目标文件</span>
cc main<span class="token punctuation">.</span>o sort<span class="token punctuation">.</span>o lookup<span class="token punctuation">.</span>o
</code></pre></div><h3 id="_2-1-2-执行环境"><a href="#_2-1-2-执行环境" class="header-anchor">#</a> 2.1.2 执行环境</h3> <p>执行过程：</p> <p>​	1.程序被载入到内存中（由操作系统完成）。哪些不存储在堆栈中的尚未初始化的变量将会初始化。</p> <p>​	2.通过一个小型启动程序和目标程序链接在一起。然后调用main函数。</p> <p>​	3.程序会使用一个运行时<strong>堆栈</strong>，它用于存储函数的局部变量和返回地址。   同时程序也会使用<strong>静态</strong>内存，其中的变量在整个过程中会一直保留原本的值。</p> <p>​	4.程序结束。可以是末尾return 0；正常结束，也可以是中途报错直接结束。</p> <h2 id="_2-2-词法规则"><a href="#_2-2-词法规则" class="header-anchor">#</a> 2.2 词法规则</h2> <h3 id="三字母词"><a href="#三字母词" class="header-anchor">#</a> 三字母词</h3> <p>通过??x的形式可以转义出其他符号，部分样例如下表</p> <table><thead><tr><th>??(</th> <th>[</th> <th></th> <th>??&lt;</th> <th>{</th> <th></th> <th>??=</th> <th>#</th></tr></thead> <tbody><tr><td>??)</td> <td>]</td> <td></td> <td>??&gt;</td> <td>}</td> <td></td> <td>??/</td> <td>\</td></tr> <tr><td>??!</td> <td>|</td> <td></td> <td>??'</td> <td>^</td> <td></td> <td>??-</td> <td>~</td></tr></tbody></table> <p>现在转义一般用 ‘ \ ’。三字母词平时其实非常少见。</p> <h1 id="_3、数据"><a href="#_3、数据" class="header-anchor">#</a> 3、数据</h1> <h2 id="_3-1-基本数据类型"><a href="#_3-1-基本数据类型" class="header-anchor">#</a> 3.1 基本数据类型</h2> <h3 id="_3-1-1-整型"><a href="#_3-1-1-整型" class="header-anchor">#</a> 3.1.1 整型</h3> <h4 id="整型字面值"><a href="#整型字面值" class="header-anchor">#</a> 整型字面值</h4> <p>字面值如 1，2，FF这些数值，它们本身不能再改变。</p> <p>变量的最小范围</p> <table><thead><tr><th>类型</th> <th>最小范围</th></tr></thead> <tbody><tr><td>char</td> <td>0-127</td></tr> <tr><td>signed char</td> <td>-127-127</td></tr> <tr><td>unsigned char</td> <td>0-255</td></tr> <tr><td>short int</td> <td>-32767-32767</td></tr> <tr><td>unsigned short int</td> <td>0-65535</td></tr> <tr><td>int</td> <td>-32767-32767</td></tr> <tr><td>unsigned int</td> <td>0-65535</td></tr> <tr><td>long int</td> <td>-2147483647-2147483647</td></tr> <tr><td>unsigned long int</td> <td>0-4294967295</td></tr></tbody></table> <p>头文件limits.h说明了各种不同的整数类型的特点。</p> <p>如：CHAR_BIT 是字符型的位数，CHAR_MIN、CHAR_MAX定义了缺省字符类型的范围。 MB_LEN_MAX规定了一个多字节字符最多允许的字符数量。</p> <table><thead><tr><th></th> <th>signed</th> <th>signed</th> <th>unsigned</th></tr></thead> <tbody><tr><td>类型</td> <td>最小值</td> <td>最大值</td> <td>最大值</td></tr> <tr><td>字符</td> <td>SCHAR_MIN</td> <td>SCHAR_MAX</td> <td>UCHAR_MAX</td></tr> <tr><td>短整型</td> <td>SHRT_MIN</td> <td>SHRT_MAX</td> <td>USHRT_MAX</td></tr> <tr><td>整型</td> <td>INT_MIN</td> <td>INT_MAX</td> <td>UNIT_MAX</td></tr> <tr><td>长整型</td> <td>LONG_MIN</td> <td>LONG_MAX</td> <td>ULONG_MAX</td></tr></tbody></table> <p>事实上，不同的机器中char可能有不同范围的值。</p> <h4 id="枚举类型-enumerated"><a href="#枚举类型-enumerated" class="header-anchor">#</a> 枚举类型(enumerated)</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">enum</span> <span class="token class-name">Jar_Type</span><span class="token punctuation">{</span>CUP<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>PINT<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>QUART<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>
			HALF_GALLON<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>GALLON<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>上例中，Jar_Type被声明为一个枚举类型，CUP、PINT等为符号常量，后续可以直接引用。</p> <p>假如没有设置CUP、PINT等符号等于什么值，那么默认CUP=0、PINT=1 以此类推。</p> <p>假如有的符号有设置值，而有的没有，那未设置值的符号，默认比前一个符号大1。</p> <h3 id="_3-1-2-浮点类型"><a href="#_3-1-2-浮点类型" class="header-anchor">#</a> 3.1.2 浮点类型</h3> <p>头文件float.h 定义了名字FLT_MAX、DBL_MAX和LDBL_MIN，分别表示float、double和long double所能存储的最大值。对应的xxx_MIN存最小值。</p> <h3 id="_3-1-3-指针"><a href="#_3-1-3-指针" class="header-anchor">#</a> 3.1.3 指针</h3> <h4 id="指针常量"><a href="#指针常量" class="header-anchor">#</a> 指针常量</h4> <p>每次调用一个函数时，它的局部变量可能每次分配的内存位置都不一样。</p> <h4 id="字符串常量"><a href="#字符串常量" class="header-anchor">#</a> 字符串常量</h4> <p>定义：一串以NULL字节结尾的零个或多个字符。存入字符数组中。</p> <h2 id="_3-2声明"><a href="#_3-2声明" class="header-anchor">#</a> 3.2声明</h2> <h3 id="_3-2-2数组声明"><a href="#_3-2-2数组声明" class="header-anchor">#</a> 3.2.2数组声明</h3> <p>C编译器不会检查数组下标是否越界。</p> <p>如果下标值是从那些已知是正确的值 (比如直接声明a[100]) 计算得来的，就不用检查它的值。如果是其他方法或者用户输入得到的 (比如a[n]，这里的n可以计算得出，也可以用户输入) , 就需要检查它的值防止越界。</p> <h3 id="_3-2-3-指针声明"><a href="#_3-2-3-指针声明" class="header-anchor">#</a> 3.2.3 指针声明</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//声明一个指针</span>
<span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>
<span class="token comment">//声明多个指针</span>
<span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">,</span><span class="token operator">*</span>c<span class="token punctuation">,</span><span class="token operator">*</span>d<span class="token punctuation">;</span>
<span class="token comment">//字符串</span>
<span class="token keyword">char</span> <span class="token operator">*</span>message<span class="token operator">=</span><span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//上一句的具体过程</span>
<span class="token keyword">char</span> <span class="token operator">*</span>message<span class="token punctuation">;</span>
message<span class="token operator">=</span><span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-2-4隐式声明"><a href="#_3-2-4隐式声明" class="header-anchor">#</a> 3.2.4隐式声明</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//编译器会默认f返回整型</span>
</code></pre></div><p>隐式声明建议不用，很容易降低代码可读性。</p> <h2 id="_3-3-typedef"><a href="#_3-3-typedef" class="header-anchor">#</a> 3.3 typedef</h2> <p>typedef的目的：为各种数据类型定义新名字。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>ptr_tp_char<span class="token punctuation">;</span>
ptr_to_char a<span class="token punctuation">;</span>   <span class="token comment">//等价于char *a;</span>
</code></pre></div><p>定义类型名最好用typedef而不是用#define，后者无法正确地处理指针类型。</p> <h2 id="_3-4-常量"><a href="#_3-4-常量" class="header-anchor">#</a> 3.4 常量</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>   <span class="token comment">//等价于int *const p;</span>
<span class="token comment">//该指针所指向的内容可以修改，但是不能修改地址。</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
<span class="token comment">//该指针可以修改地址，但不能修改所指向的值</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> p<span class="token punctuation">;</span>
<span class="token comment">//该指针一初始化就不能修改。</span>

<span class="token comment">//一般常量声明</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_ELEMENTS</span> <span class="token expression"><span class="token number">50</span></span></span>
<span class="token keyword">int</span> <span class="token keyword">const</span> max_elements<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span>
</code></pre></div><p>定义一个名字常量的好处在于，后续维护程序时，只用修改声明部分就能修改所有相关的地方。</p> <h2 id="_3-6-链接属性"><a href="#_3-6-链接属性" class="header-anchor">#</a> 3.6 链接属性</h2> <p>连接属性分类：external(外部)、internal(内部)、none(无)</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">extern</span> <span class="token keyword">int</span> k<span class="token punctuation">;</span>
<span class="token comment">//声明为extern的k将是外部文件的一个同名变量</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span>
<span class="token comment">//声明为static的b将为当前的源文件私有</span>
<span class="token comment">//在其他源文件中，若链接到一个叫做b的变量，那么它引用的将</span>
<span class="token comment">//是另一个不同的变量</span>

<span class="token comment">//对函数也可以如此声明，这样可以防止外部文件的调用。</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-7-存储类型"><a href="#_3-7-存储类型" class="header-anchor">#</a> 3.7 存储类型</h2> <p>分类：普通内存、运行时堆栈、硬件寄存器</p> <p>使用频率高的变量可以声明为寄存器变量(register关键字)。</p> <p>寄存器变量的创建和销毁时间和局部变量相同，但它需要一些额外工作。在一个使用寄存器变量的函数返回之前，这些寄存器先前存储的值必须恢复，确保调用者的寄存器变量未被破坏。</p> <p>当函数开始执行时，它把需要使用的所有寄存器的内容都保存到堆栈中，当函数返回时，这些值再复制回到寄存器中。</p> <p>某个特定的寄存器在不同的时刻所保持的值不一定相同。因此，机器不会提供寄存器变量的地址。</p> <h4 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h4> <p>静态变量若不显式地初始化，将默认赋值为0。</p> <p>局部变量若不显式地初始化，将会有更多开销，因为当程序链接时还无法判断局部变量的存储位置。<u>局部变量最好显式初始化</u>。</p> <h2 id="_3-8-static-关键字"><a href="#_3-8-static-关键字" class="header-anchor">#</a> 3.8 static 关键字</h2> <p>static有两种用法：</p> <p>1.用于函数定义、或用于代码块之外的变量声明时，static用于修改标识符的链接属性，从external改为internal，但标识符的存储类型和作用域不受影响。用这种方式声明的函数或变量只能在声明它们的源文件中访问。</p> <p>2.用于代码块内部的变量声明时，static用于修改变量的存储类型，将局部变量转为静态变量，但是变量的链接属性和作用域不受影响。</p> <h2 id="_3-10-小结"><a href="#_3-10-小结" class="header-anchor">#</a> 3.10 小结</h2> <table><thead><tr><th>变量类型</th> <th>声明位置</th> <th>是否存于堆栈</th> <th>作用域</th> <th>如果声明为static</th></tr></thead> <tbody><tr><td>全局</td> <td>所有代码块之外</td> <td>F</td> <td>从声明出到文件尾</td> <td>不允许从其他源文件访问</td></tr> <tr><td>局部</td> <td>代码块起始处</td> <td>T</td> <td>整个代码块</td> <td>变量不存储与堆栈中，它们的值在程序整个执行期一直保持</td></tr> <tr><td>形式参数</td> <td>函数头部</td> <td>T</td> <td>整个函数</td> <td>不允许</td></tr></tbody></table> <h2 id="警告的总结"><a href="#警告的总结" class="header-anchor">#</a> 警告的总结</h2> <p>1.在声明指针变量时采用容易误导的写法。</p> <p>2.误解指针声明中初始化的含义。</p> <h2 id="编程提示总结"><a href="#编程提示总结" class="header-anchor">#</a> 编程提示总结</h2> <p>1.为了保持最佳的可移植性，把字符的值限制在有符号和无符号字符范围的交集之内，或者不要在字符上执行算术运算。</p> <p>2.用它们在使用时最自然的形式来表示字面值。</p> <p>3.不要把整型值和枚举值混为一谈。</p> <p>4.不要依赖隐式声明。</p> <p>5.在定义类型的新名字时，使用typedef而不是#define</p> <p>6.用const声明其值不会修改的变量。</p> <p>7.使用名字常量而不是字面值常量。</p> <p>8.不要再嵌套的代码块之间使用相同的变量名。</p> <p>9.除了实体的具体定义位置之外，在它的其他声明位置都使用extern关键字。</p> <h1 id="_4、语句"><a href="#_4、语句" class="header-anchor">#</a> 4、语句</h1> <h2 id="警告的总结-2"><a href="#警告的总结-2" class="header-anchor">#</a> 警告的总结</h2> <p>1.编写不会产生任何结果的表达式。</p> <p>2.确信在if语句中的语句列表前后加上花括号。</p> <p>3.在switch语句中，执行流意外地从一个case顺延到下一个case。</p> <h2 id="编程提示总结-2"><a href="#编程提示总结-2" class="header-anchor">#</a> 编程提示总结</h2> <p>1.在一个没有循环体的循环中，用一个分号表示空语句，并让它独占一行。</p> <p>2.for循环的可读性比whlie循环强，因为它把用于控制循环的表达式收集起来放在同一处。</p> <p>3.switch语句中必要时使用default子句。</p> <h1 id="_5、操作符和表达式"><a href="#_5、操作符和表达式" class="header-anchor">#</a> 5、操作符和表达式</h1> <h1 id="_5-1操作符"><a href="#_5-1操作符" class="header-anchor">#</a> 5.1操作符</h1> <h3 id="_5-1-1算术操作符"><a href="#_5-1-1算术操作符" class="header-anchor">#</a> 5.1.1算术操作符</h3> <p>+、-、*、/、%</p> <h3 id="_5-1-2移位操作符"><a href="#_5-1-2移位操作符" class="header-anchor">#</a> 5.1.2移位操作符</h3> <p>操作对象：整数类型</p> <p>左移：&gt;&gt;</p> <p>右移：&lt;&lt;
<img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/1fa72c6ed15f44e19b422c6f3fb51bae.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_11,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>对于有符号值，到底是采用逻辑移位还是算数移位(会保持当前符号)取决于编译器。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
* 该函数返回参数值二进制中值为1的位的个数 （初级版本）
*/</span>
<span class="token keyword">int</span> <span class="token function">count_one_bits</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> ones<span class="token punctuation">;</span>
    <span class="token comment">//当这个值还有一些值为1的位时。</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>ones<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>value<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>value<span class="token operator">=</span>value<span class="token operator">&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">)</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">%</span><span class="token number">2</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  
            ones<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> ones
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-1-3-位操作符"><a href="#_5-1-3-位操作符" class="header-anchor">#</a> 5.1.3 位操作符</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/803a3f7cef044dc18166e9a9973009b8.png#pic_center" loading="lazy" class="lazy"></p> <p>例：</p> <table><thead><tr><th>a</th> <th>00101110</th></tr></thead> <tbody><tr><td>b</td> <td>01011011</td></tr> <tr><td>a&amp;b</td> <td>00001010</td></tr> <tr><td>a|b</td> <td>01111111</td></tr> <tr><td>a^b</td> <td>01110101</td></tr></tbody></table> <h3 id="_5-1-4赋值"><a href="#_5-1-4赋值" class="header-anchor">#</a> 5.1.4赋值</h3> <div class="language-c extra-class"><pre class="language-c"><code>a<span class="token operator">=</span>x<span class="token operator">=</span>y<span class="token operator">+</span><span class="token number">3</span>
</code></pre></div><p>该语句a和x被赋的值可能不同。</p> <p>假如x是一个字符型变量，那么y+3会被截去一段，以便容纳于字符类型的变量中。那么a的值将会是这个被截取后的值。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> ch<span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>EOF需要的位数比字符型值所能提供的位数要多，这也是getchar返回一个整型值而不是字符值的原因。然而，getchar的返回值首先存入ch中会导致它被截短，然后这个截短的值又会和EOF比较。</p> <p>在使用<u>有符号字符集</u>的机器上运行时，若读取了一个值为\377的字节时，循环会终止，因为这个值截短再提升之后会和EOF相等。  在使用<u>无符号字符集</u>的机器上运行时，这会成为死循环。</p> <h3 id="_5-1-8-条件操作符"><a href="#_5-1-8-条件操作符" class="header-anchor">#</a> 5.1.8 条件操作符</h3> <p>expression1 ? expression2 : expression3</p> <h3 id="_5-1-9-逗号操作符"><a href="#_5-1-9-逗号操作符" class="header-anchor">#</a> 5.1.9 逗号操作符</h3> <p>expression1 , expression2 ,....,expressionN</p> <h3 id="_5-1-10-下标引用、函数调用和结构成员"><a href="#_5-1-10-下标引用、函数调用和结构成员" class="header-anchor">#</a> 5.1.10 下标引用、函数调用和结构成员</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//下面两种下标引用方式等价</span>
array<span class="token punctuation">[</span>下标<span class="token punctuation">]</span>
<span class="token operator">*</span><span class="token punctuation">(</span>array<span class="token operator">+</span><span class="token punctuation">(</span>下标<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token comment">//结构变量访问成员</span>
s<span class="token punctuation">.</span>a
<span class="token comment">//结构指针访问成员</span>
p<span class="token operator">-&gt;</span>a
</code></pre></div><h2 id="_5-3左值和右值"><a href="#_5-3左值和右值" class="header-anchor">#</a> 5.3左值和右值</h2> <p>一般来说，佐治就是那些能够出现在赋值符号左边的东西，右值就是那些可以出现在赋值符号右边的东西。</p> <div class="language-c extra-class"><pre class="language-c"><code>a<span class="token operator">=</span>b<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span>
<span class="token comment">//a是左值，b+10这个整体是右值。</span>
<span class="token comment">//a在后续使用可以出现 xxx=a的形式，因此，a还可以当作右值</span>
<span class="token comment">//b+10不能出现b+10=xxx的形式，因此，b+10不能当作左值</span>
</code></pre></div><h2 id="_5-4-表达式求值"><a href="#_5-4-表达式求值" class="header-anchor">#</a> 5.4 表达式求值</h2> <h3 id="_5-4-1隐式类型转换"><a href="#_5-4-1隐式类型转换" class="header-anchor">#</a> 5.4.1隐式类型转换</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
a<span class="token operator">=</span>b<span class="token operator">+</span>c<span class="token punctuation">;</span>
<span class="token comment">//b、c的值被提升为普通整型再做加法运算，结果将被截短再存入a中</span>
</code></pre></div><h3 id="_5-4-2-算术转换"><a href="#_5-4-2-算术转换" class="header-anchor">#</a> 5.4.2 算术转换</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> c<span class="token operator">=</span>a<span class="token operator">*</span>b<span class="token punctuation">;</span>
<span class="token comment">//第三行在32位整数的机器上运行无问题，但是在16位整数的机器</span>
<span class="token comment">//上会出现乘法运算溢出。  可以改为以下形式</span>
<span class="token keyword">long</span> c<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>a<span class="token operator">*</span>b
</code></pre></div><h3 id="_5-4-3操作符的属性"><a href="#_5-4-3操作符的属性" class="header-anchor">#</a> 5.4.3操作符的属性</h3> <p>复杂表达式的求值顺序由3个因素决定：操作符的优先级、操作符的结合性、操作符是否控制执行的顺序。</p> <h2 id="警告的总结-3"><a href="#警告的总结-3" class="header-anchor">#</a> 警告的总结</h2> <p>1.有符号值得右移位操作是不可移植的。</p> <p>2.移位操作的位数是个负值。</p> <p>3.连续赋值中各个变量的长度不一。</p> <p>4.误用=而不是==进行比较。</p> <p>5.误用|替代||，或误用&amp;替代&amp;&amp;。</p> <p>6.在不同的用于表示布尔值的非零值之间进行比较。</p> <p>7.表达式赋值的位置并不决定表达式计算的精度。</p> <p>8.编写结果依赖于求值顺序的表达式。</p> <h2 id="编程提示总结-3"><a href="#编程提示总结-3" class="header-anchor">#</a> 编程提示总结</h2> <p>1.使用复合赋值符可以使程序更易于维护。</p> <p>2.使用条件操作符替代if语句以简化表达式。</p> <p>3.使用逗号操作符来消除多余的代码。</p> <p>4.不要混用整型和布尔型值。</p> <h1 id="_6、指针"><a href="#_6、指针" class="header-anchor">#</a> 6、指针</h1> <h2 id="_6-1-内存和地址"><a href="#_6-1-内存和地址" class="header-anchor">#</a> 6.1 内存和地址</h2> <p>变量名字和内存位置之间的关联并不是由硬件所提供的，它是由编译器为我们实现的。所有这些变量给我们一种更方便的方法记住地址--<strong>硬件仍然通过地址访问内存位置</strong>。</p> <h2 id="_6-4-间接访问操作符"><a href="#_6-4-间接访问操作符" class="header-anchor">#</a> 6.4 间接访问操作符</h2> <p>间接访问：通过一个指针访问它所指向的地址的过程。又称引用指针。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token operator">=</span>a<span class="token punctuation">;</span>
<span class="token comment">//p本身存储的是a的地址。通过*p可以访问到a的地址获取值100.</span>
</code></pre></div><h2 id="_6-5-未初始化和非法指针"><a href="#_6-5-未初始化和非法指针" class="header-anchor">#</a> 6.5 未初始化和非法指针</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>
<span class="token operator">*</span>a<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>
<span class="token comment">//a指针未初始化，我们不知道a所存储的地址到底是何处。</span>
<span class="token comment">//因此，每次构建指针的时候一定要初始化指针所存储的地址。</span>

<span class="token comment">//比如</span>
<span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>
a<span class="token operator">=</span>p<span class="token punctuation">;</span>    <span class="token comment">//这一步给了a一个地址</span>
<span class="token operator">*</span>a<span class="token operator">=</span><span class="token number">1</span>；
<span class="token comment">//同样的还可以  int *a=p;</span>
</code></pre></div><h2 id="_6-6null指针"><a href="#_6-6null指针" class="header-anchor">#</a> 6.6NULL指针</h2> <p>NULL指针表示不指向任何东西。要使一个指针变量未NULL，你可以给它赋一个零值。   它可以用来判断某个特定指针目前是否有指向什么东西。</p> <p>在使用一个指针前，可以优先判断它是不是NULL指针。</p> <h2 id="_6-7指针、间接访问和左值"><a href="#_6-7指针、间接访问和左值" class="header-anchor">#</a> 6.7指针、间接访问和左值</h2> <p>指针变量可以作为左值，是因为它们是变量，而不是因为它们是指针。</p> <h2 id="_6-8指针、间接访问和变量"><a href="#_6-8指针、间接访问和变量" class="header-anchor">#</a> 6.8指针、间接访问和变量</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token operator">*</span><span class="token operator">&amp;</span>a<span class="token operator">=</span><span class="token number">25</span>；
<span class="token comment">//&amp;操作符产生a的地址，*操作访问这个地址，最后将25存入该地址。</span>
</code></pre></div><p>上句结果和a=25相同。但是上句设计更多的操作，容易降低代码的可读性。</p> <h2 id="_6-9指针常量"><a href="#_6-9指针常量" class="header-anchor">#</a> 6.9指针常量</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">100</span><span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>  
<span class="token comment">//强制类型转换把100从“整型”变为“指向整型的指针”</span>
</code></pre></div><p>这个技巧的主要用途是访问某个具体的地址。例如，操作系统需要与输入输出设备控制器通信，启动I/O操作并从前面的操作中获得结果。</p> <h2 id="_6-10指针表达式"><a href="#_6-10指针表达式" class="header-anchor">#</a> 6.10指针表达式</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> ch<span class="token operator">=</span><span class="token char">'a'</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>cp<span class="token operator">=</span>ch<span class="token punctuation">;</span>
<span class="token operator">*</span>cp<span class="token operator">+</span><span class="token number">1</span>  <span class="token comment">//取出cp指向地址的内容'a'并+1</span>
<span class="token operator">*</span><span class="token punctuation">(</span>cp<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//获取cp所指向地址的后一个地址。数组的下标操作基于此式</span>
cp<span class="token operator">++</span>  <span class="token comment">//将cp所指向的地址移向下一块地址</span>
    
<span class="token operator">*</span>cp<span class="token operator">++</span>  <span class="token comment">//1.++操作符产生cp的一份拷贝。2.++操作符增加cp的值。</span>
       <span class="token comment">//3.在cp的拷贝上执行间接访问操作</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> length<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//依次访问字符串的内容，计算字符数，直到遇见NULL终止符</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>string<span class="token operator">++</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
        length<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> length<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//这个函数统计的确实是字符串的长度，但是没有统计首个字符，</span>
<span class="token comment">//而是用'\0'代替首字符进行统计</span>
</code></pre></div><h2 id="_6-13指针运算"><a href="#_6-13指针运算" class="header-anchor">#</a> 6.13指针运算</h2> <p>如果p是指向x类型的指针，那么p+1就是指向下一个x类型的指针。</p> <p>1.p+i得到p之后第i个x类型的指针。</p> <p>2.指针-指针，结果是两个指针在内存中的距离</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">for</span><span class="token punctuation">(</span>vp<span class="token operator">=</span><span class="token operator">&amp;</span>values<span class="token punctuation">[</span>N_VALUES<span class="token punctuation">]</span><span class="token punctuation">;</span>vp<span class="token operator">&gt;</span><span class="token operator">&amp;</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>
	<span class="token operator">*</span><span class="token operator">--</span>vp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span>vp<span class="token operator">=</span><span class="token operator">&amp;</span>values<span class="token punctuation">[</span>N_VALUES<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>vp<span class="token operator">&gt;=</span><span class="token operator">&amp;</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>vp<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token operator">*</span>vp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//第二个循环结束之后vp会发生越界</span>
</code></pre></div><h2 id="警告的总结-4"><a href="#警告的总结-4" class="header-anchor">#</a> 警告的总结</h2> <p>1.错误地对一个未初始化的指针变量进行解引用。</p> <p>2.错误地对一个NULL指针进行解引用。</p> <p>3.像函数错误地传递NULL指针。</p> <p>4.未检测到指针表达式的错误，从而导致不可预测的结果。</p> <p>5。对一个指针进行减法运算，是它非法地指向了数组第1个元素的前面的内存位置。</p> <h2 id="编程提示的总结-2"><a href="#编程提示的总结-2" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.一个值应该只具有一种意思。</p> <p>2.如果指针并不只想任何有意义的东西，就把它设置为NULL。</p> <h1 id="_7、函数"><a href="#_7、函数" class="header-anchor">#</a> 7、函数</h1> <h2 id="_7-5递归和迭代"><a href="#_7-5递归和迭代" class="header-anchor">#</a> 7.5递归和迭代</h2> <p>对于计算阶乘和斐波那契数列来说，递归并没有提供任何优越之处，而且效率非常低。</p> <p>递归通过栈实现。</p> <p>迭代即递推。计算阶乘和斐波那契数列用迭代效率会高非常多。</p> <h2 id="_7-6可变参数列表"><a href="#_7-6可变参数列表" class="header-anchor">#</a> 7.6可变参数列表</h2> <p>目的：让一个函数在不同时候接受不同数目的参数。</p> <h3 id="_7-6-1-stdarg宏"><a href="#_7-6-1-stdarg宏" class="header-anchor">#</a> 7.6.1 stdarg宏</h3> <p>头文件:stdarg.h</p> <p>这个头文件声明了 一个类型va_list 和三个宏——va_start、va_arg、va_end。</p> <p>函数声明一个名叫var_arg的变量，用于访问参数列表的未确定部分。该变量通过va_start初始化。它的第1个参数是va_list变量的名字，第2个参数是省略号前最后一个有名字的参数。初始化过程把var_arg变量设置为指向可变参数部分的第1个参数。</p> <p>为了访问参数，需要使用va_arg，这个宏接受两个参数：va_list变量和参数列表中下一个参数的类型。    在有些函数中，你可能要通过前面获得的数据来判断下一个参数的类型。va_arg返回这个参数的值，并使var_arg指向下一个可变参数。</p> <p>最后，当访问完毕最后一个可变参数之后，我们需要调用va_end。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//计算指定数量的值的平均值</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdarg.h&gt;</span></span>
<span class="token keyword">float</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token keyword">int</span> n_values<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    va_list var_arg<span class="token punctuation">;</span>
    <span class="token keyword">int</span> count<span class="token punctuation">;</span>
    <span class="token keyword">float</span> sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//准备访问可变参数</span>
    <span class="token function">va_start</span><span class="token punctuation">(</span>var_arg<span class="token punctuation">,</span>n_values<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加取自可变参数列表的值</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>count<span class="token operator">&lt;</span>n_values<span class="token punctuation">;</span>count<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        sum<span class="token operator">+=</span><span class="token function">va_arg</span><span class="token punctuation">(</span>var_arg<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//第二个参数表示下一个参									//数的类型</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//完成处理可变参数</span>
    <span class="token function">va_end</span><span class="token punctuation">(</span>var_arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sum<span class="token operator">/</span>n_values<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不过，va_arg无法正确识别作用于可变参数之上的缺省参数类型提升。char、short、float类型的值实际上将作为int或double类型的值传递给函数。</p> <h2 id="警告的总结-5"><a href="#警告的总结-5" class="header-anchor">#</a> 警告的总结</h2> <p>1.错误地在其他函数的作用域内编写函数原型。</p> <p>2.没有为那些返回值不是整型的函数编写原型。</p> <p>3.把函数原型和旧式风格的函数定义混合使用。</p> <p>4.在va_arg中使用错误的参数类型，导致未定义的结果。</p> <h2 id="编程提示的总结-3"><a href="#编程提示的总结-3" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.在函数原型中使用参数名，可以给使用该函数的用户提供更多的信息。</p> <p>2.抽象数据类型可以减少程序对模块实现细节的依赖，从而提高程序的可靠性。</p> <p>3.当递归定义清晰的有点可以补偿它的效率开销时，就可以使用这个工具。</p> <h1 id="_8、数组"><a href="#_8、数组" class="header-anchor">#</a> 8、数组</h1> <p>数组本质是指针。</p> <h2 id="_8-1一维数组"><a href="#_8-1一维数组" class="header-anchor">#</a> 8.1一维数组</h2> <h3 id="_8-1-2-下标引用"><a href="#_8-1-2-下标引用" class="header-anchor">#</a> 8.1.2 下标引用</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//这两句话等价</span>
array<span class="token punctuation">[</span>subscript<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token punctuation">(</span>array<span class="token operator">+</span><span class="token punctuation">(</span>subscript<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>ap<span class="token operator">=</span>array<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token operator">*</span>ap<span class="token operator">+</span><span class="token number">6</span>   <span class="token comment">//相当于array[2]+6</span>
<span class="token operator">*</span><span class="token punctuation">(</span>ap<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">//相当于array[2+6]</span>
ap<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment">//array[1]</span>

<span class="token number">2</span><span class="token punctuation">[</span>array<span class="token punctuation">]</span> <span class="token comment">//等价于array[2],不过不推荐写</span>
</code></pre></div><p>指针有时比下标更有效率。</p> <h3 id="_8-1-5-数组和指针"><a href="#_8-1-5-数组和指针" class="header-anchor">#</a> 8.1.5 数组和指针</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>
<span class="token comment">//*a合法，*b不合法。因为*b会访问内存中的未知位置</span>
<span class="token comment">//b++合法，a++非法。因为a的值是个常量</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/f046617758484a1c82c01cddb19053fe.png#pic_center" loading="lazy" class="lazy"></p> <h3 id="_8-1-8初始化"><a href="#_8-1-8初始化" class="header-anchor">#</a> 8.1.8初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//完整初始化</span>
<span class="token keyword">int</span> vector<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//不完整初始化</span>
<span class="token keyword">int</span> vector<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//未初始化的部分默认为0。不能出现超出数					//组范围的初始化</span>
<span class="token comment">//自动计算长度</span>
<span class="token keyword">int</span> vector<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//字符数组初始化</span>
<span class="token keyword">char</span> message<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token char">'H'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span><span class="token char">'l'</span><span class="token punctuation">,</span><span class="token char">'o'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> message<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> message1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>message2<span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//这两种声明方式的结果有区别，见下图</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/d2d87e0a8cb04607a8d21cfffa3ebc9f.png#pic_center" loading="lazy" class="lazy"></p> <h2 id="_8-2多维数组"><a href="#_8-2多维数组" class="header-anchor">#</a> 8.2多维数组</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/4997fed084a44f968a91a7b7ce3a6603.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h3 id="_8-2-3-下标"><a href="#_8-2-3-下标" class="header-anchor">#</a> 8.2.3 下标</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/902d4976d75043479557dc15bcb0d04f.png#pic_center" loading="lazy" class="lazy"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/9e36d195a27b405882161ac1868c841e.png#pic_center" loading="lazy" class="lazy"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/301a2eb948cc4186a1c3306115b04d9c.png#pic_center" loading="lazy" class="lazy"><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/754c2e734dfd478fbb5393393c8c63ef.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"> <img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/18027cd177c34864ab75d92b7c9c755e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h3 id="_8-2-4指向数组的指针"><a href="#_8-2-4指向数组的指针" class="header-anchor">#</a> 8.2.4指向数组的指针</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> vector<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>vp<span class="token operator">=</span>vector<span class="token punctuation">;</span>  <span class="token comment">//合法</span>
<span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>mp<span class="token operator">=</span>matrix<span class="token punctuation">;</span>  <span class="token comment">//非法</span>
<span class="token comment">//matrix是一个指向整型数组的指针</span>

<span class="token comment">//声明一个指向整型数组的指针</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//初始化</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">=</span>matrix<span class="token punctuation">;</span>  <span class="token comment">//p指向matrix的第一行</span>


<span class="token comment">//两种方式创建一个简单的整型指针</span>
<span class="token keyword">int</span> <span class="token operator">*</span>pi<span class="token operator">=</span><span class="token operator">&amp;</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>pi<span class="token operator">=</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_8-2-5作为函数参数的多维数组"><a href="#_8-2-5作为函数参数的多维数组" class="header-anchor">#</a> 8.2.5作为函数参数的多维数组</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//两种等价引用</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>matrix<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> mat<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_8-2-6初始化"><a href="#_8-2-6初始化" class="header-anchor">#</a> 8.2.6初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">00</span><span class="token punctuation">,</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">,</span><span class="token number">03</span><span class="token punctuation">,</span><span class="token number">04</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//初始化一个三维数组</span>
<span class="token keyword">int</span> three_dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token number">000</span><span class="token punctuation">,</span><span class="token number">001</span><span class="token punctuation">,</span><span class="token number">002</span><span class="token punctuation">,</span><span class="token number">003</span><span class="token punctuation">,</span><span class="token number">004</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">010</span><span class="token punctuation">,</span><span class="token number">011</span><span class="token punctuation">,</span><span class="token number">012</span><span class="token punctuation">,</span><span class="token number">013</span><span class="token punctuation">,</span><span class="token number">014</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">020</span><span class="token punctuation">,</span><span class="token number">021</span><span class="token punctuation">,</span><span class="token number">022</span><span class="token punctuation">,</span><span class="token number">023</span><span class="token punctuation">,</span><span class="token number">024</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//初始化一个四维数组</span>
<span class="token keyword">int</span> four_dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            <span class="token punctuation">{</span><span class="token number">0000</span><span class="token punctuation">,</span><span class="token number">0001</span><span class="token punctuation">,</span><span class="token number">0002</span><span class="token punctuation">,</span><span class="token number">0003</span><span class="token punctuation">,</span><span class="token number">0004</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">0010</span><span class="token punctuation">,</span><span class="token number">0011</span><span class="token punctuation">,</span><span class="token number">0012</span><span class="token punctuation">,</span><span class="token number">0013</span><span class="token punctuation">,</span><span class="token number">0014</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">0020</span><span class="token punctuation">,</span><span class="token number">0021</span><span class="token punctuation">,</span><span class="token number">0022</span><span class="token punctuation">,</span><span class="token number">0023</span><span class="token punctuation">,</span><span class="token number">0024</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token punctuation">{</span><span class="token number">0100</span><span class="token punctuation">,</span><span class="token number">0101</span><span class="token punctuation">,</span><span class="token number">0102</span><span class="token punctuation">,</span><span class="token number">0103</span><span class="token punctuation">,</span><span class="token number">0104</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">0110</span><span class="token punctuation">,</span><span class="token number">0111</span><span class="token punctuation">,</span><span class="token number">0112</span><span class="token punctuation">,</span><span class="token number">0113</span><span class="token punctuation">,</span><span class="token number">0114</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">0120</span><span class="token punctuation">,</span><span class="token number">0121</span><span class="token punctuation">,</span><span class="token number">0122</span><span class="token punctuation">,</span><span class="token number">0123</span><span class="token punctuation">,</span><span class="token number">0124</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            <span class="token punctuation">{</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">1010</span><span class="token punctuation">,</span><span class="token number">1011</span><span class="token punctuation">,</span><span class="token number">1012</span><span class="token punctuation">,</span><span class="token number">1013</span><span class="token punctuation">,</span><span class="token number">1014</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">1020</span><span class="token punctuation">,</span><span class="token number">1021</span><span class="token punctuation">,</span><span class="token number">1022</span><span class="token punctuation">,</span><span class="token number">1023</span><span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token punctuation">{</span><span class="token number">1100</span><span class="token punctuation">,</span><span class="token number">1101</span><span class="token punctuation">,</span><span class="token number">1102</span><span class="token punctuation">,</span><span class="token number">1103</span><span class="token punctuation">,</span><span class="token number">1104</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">1110</span><span class="token punctuation">,</span><span class="token number">1111</span><span class="token punctuation">,</span><span class="token number">1112</span><span class="token punctuation">,</span><span class="token number">1113</span><span class="token punctuation">,</span><span class="token number">1114</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token number">1120</span><span class="token punctuation">,</span><span class="token number">1121</span><span class="token punctuation">,</span><span class="token number">1122</span><span class="token punctuation">,</span><span class="token number">1123</span><span class="token punctuation">,</span><span class="token number">1124</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>




<span class="token comment">//长度自动计算</span>
<span class="token keyword">int</span> matrix<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token punctuation">{</span><span class="token number">00</span><span class="token punctuation">,</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_8-3指针数组"><a href="#_8-3指针数组" class="header-anchor">#</a> 8.3指针数组</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>api<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//api数组存的是整数型指针</span>

<span class="token keyword">char</span> <span class="token keyword">const</span> keyword<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token string">&quot;do&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;for&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;if&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;register&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;return&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;switch&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;while&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="警告的总结-6"><a href="#警告的总结-6" class="header-anchor">#</a> 警告的总结</h2> <p>1.当访问多维数组的元素时，误用逗号分隔下标。</p> <p>2.在一个指向未指定长度的数组的指针上执行指针运算。</p> <h2 id="编程提示的总结-4"><a href="#编程提示的总结-4" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.一开始就编写良好的代码显然比依赖编译器来修正劣质代码更好。</p> <p>2.源代码的可读性几乎总是比程序的运行时效率更为重要。</p> <p>3.只要有可能，函数的指针形参都应该声明为const。</p> <p>4.在有些环境中，使用register关键字提高程序的运行时效率。</p> <p>5.在多维数组的初始值列表中使用完整的多层花括号能提高可读性。</p> <h1 id="_9、字符串、字符和字节"><a href="#_9、字符串、字符和字节" class="header-anchor">#</a> 9、字符串、字符和字节</h1> <h2 id="_9-2字符串长度"><a href="#_9-2字符串长度" class="header-anchor">#</a> 9.2字符串长度</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token function">strlen</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">strlen</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">//第二个判断将永远为真，因为strlen返回一个无符号数，无符号数</span>
<span class="token comment">//不可能减出一个负值</span>
</code></pre></div><h2 id="_9-5字符串查找基础"><a href="#_9-5字符串查找基础" class="header-anchor">#</a> 9.5字符串查找基础</h2> <h3 id="_9-5-1查找一个字符"><a href="#_9-5-1查找一个字符" class="header-anchor">#</a> 9.5.1查找一个字符</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strchr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查找ch第一次出现的位置</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//查找ch最后出现的位置</span>

<span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;Hello there, honey.&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>ans<span class="token punctuation">;</span>
ans<span class="token operator">=</span><span class="token function">strchr</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span><span class="token char">'h'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ans所致的位置将是string+7</span>
</code></pre></div><h3 id="_9-5-2查找任何几个字符"><a href="#_9-5-2查找任何几个字符" class="header-anchor">#</a> 9.5.2查找任何几个字符</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strpbrk</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//该函数返回一个指向str中第1个匹配group中任何一个字符的字符位置，未找到则返回NULL指针</span>

<span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;Hello there, honey.&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>ans<span class="token punctuation">;</span>
ans<span class="token operator">=</span><span class="token function">strchr</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span><span class="token char">'aeiou'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ans将指向string+1</span>
</code></pre></div><h3 id="_9-5-3查找一个字串"><a href="#_9-5-3查找一个字串" class="header-anchor">#</a> 9.5.3查找一个字串</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>s1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//该函数在s1中查找整个s2第一次出现的 起始位置</span>
<span class="token comment">//不过标准库中没有 strrstr 函数，需要自己实现。</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">my_strrstr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>s1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>s2<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//在s1中查找字符串s2最右出现的位置，并返回一个该位置的指针</span>
    <span class="token keyword">register</span> <span class="token keyword">char</span> <span class="token operator">*</span>last<span class="token punctuation">;</span>
    <span class="token keyword">register</span> <span class="token keyword">char</span> <span class="token operator">*</span>current<span class="token punctuation">;</span>
    <span class="token comment">//把指针初始化为我们已经找到的前一次匹配位置</span>
    last<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token comment">//旨在第2个字符串不为空时才进行查找，若s2为空，返回NULL。</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>s2<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//查找s2在s1中第1次出现的位置</span>
        current<span class="token operator">=</span><span class="token function">strstr</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//我们每次找到字符串时，让指针指向它的起始位置，然后查找该字符串的下一个匹配位置</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>current<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            last<span class="token operator">=</span>current<span class="token punctuation">;</span>
            current<span class="token operator">=</span><span class="token function">strstr</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//返回指向我们找到的最后一次匹配的起始位置的指针</span>
    <span class="token keyword">return</span> last<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-6高级字符串查找"><a href="#_9-6高级字符串查找" class="header-anchor">#</a> 9.6高级字符串查找</h2> <h3 id="_9-6-1查找一个字符串前缀"><a href="#_9-6-1查找一个字符串前缀" class="header-anchor">#</a> 9.6.1查找一个字符串前缀</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token class-name">size_t</span> <span class="token function">strspn</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回str起始部分匹配group中仍以字符的字符数</span>
<span class="token keyword">int</span> len1<span class="token punctuation">,</span>len2<span class="token punctuation">;</span>
<span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;25,142,330,Smith,J,239-4123&quot;</span><span class="token punctuation">;</span>

len1<span class="token operator">=</span><span class="token function">strspn</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;0123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//len1=2</span>
len2<span class="token operator">-</span><span class="token function">strspn</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;,0123456789&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//len2=11</span>


<span class="token class-name">size_t</span> <span class="token function">strcspn</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回str字符串起始部分中不与group中任何字符匹配的字符数。</span>
</code></pre></div><h3 id="_9-6-2查找标记"><a href="#_9-6-2查找标记" class="header-anchor">#</a> 9.6.2查找标记</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strtok</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>sep<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//sep定义了用作分隔符的 字符集合 。strtok找到str的下一个标记，并将其用NULL结尾，然后返回一个指向这个标记的指针。</span>
<span class="token comment">//str会被修改</span>
<span class="token comment">//如果第1个参数是NULL，函数就在同一个字符串中从这个被保存的位置开始像前面一样查找下一个标记</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">print_tolens</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>line<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//从一个字符数组中提取空白字符分割的标记并把它们打印出来(每行一个)。</span>
    <span class="token keyword">static</span> <span class="token keyword">char</span> whitespace<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot; \t\f\r\v\n&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>token<span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span>token<span class="token operator">=</span><span class="token function">strtok</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span>whitespace<span class="token punctuation">)</span><span class="token punctuation">;</span>
       token<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
       token<span class="token operator">=</span><span class="token function">strtok</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span>whitespace<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//第一个参数为NULL，因此直接从token的位置开始寻找下一处分隔标记</span>
          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Next token is %s\n&quot;</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-7错误信息"><a href="#_9-7错误信息" class="header-anchor">#</a> 9.7错误信息</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strerror</span><span class="token punctuation">(</span><span class="token keyword">int</span> error_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//该函数把其中一个错误代码作为参数并返回一个指向用于描述错误的字符串指针</span>
</code></pre></div><h2 id="_9-8字符操作"><a href="#_9-8字符操作" class="header-anchor">#</a> 9.8字符操作</h2> <p>头文件：ctype.h</p> <h3 id="_9-8-1字符分类"><a href="#_9-8-1字符分类" class="header-anchor">#</a> 9.8.1字符分类</h3> <table><thead><tr><th>函数</th> <th>如果它的参数复合下列条件就返回真</th></tr></thead> <tbody><tr><td>iscntrl</td> <td>任何控制字符</td></tr> <tr><td>isspace</td> <td>空白字符：空格' '、换页'\f'、换行'\n'、回车'\r'、制表符'\t \v'</td></tr> <tr><td>isdigit</td> <td>十进制数字0~9</td></tr> <tr><td>isxdigit</td> <td>十六进制数字，包括所有十进制数字。a(A)~f(F)</td></tr> <tr><td>islower</td> <td>小写字母a~z</td></tr> <tr><td>isupper</td> <td>大写字母A~Z</td></tr> <tr><td>isalpha</td> <td>大小写字母</td></tr> <tr><td>isalnum</td> <td>字母或数字</td></tr> <tr><td>ispunct</td> <td>标点符号，任何不属于数字或字母的图形字符</td></tr> <tr><td>isgraph</td> <td>任何图形字符</td></tr> <tr><td>isprint</td> <td>任何可打印字符，包括图形字符和空白字符</td></tr></tbody></table> <h3 id="_9-8-2字符转换"><a href="#_9-8-2字符转换" class="header-anchor">#</a> 9.8.2字符转换</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">tolower</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//字母转小写</span>
<span class="token keyword">int</span> <span class="token function">toupper</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_9-9内存操作"><a href="#_9-9内存操作" class="header-anchor">#</a> 9.9内存操作</h2> <p>目的：避免非字符串数据内部包含零值的情况，这类情况无法使用字符串函数来处理，因为当它们遇到第一个NULL字节时将停止工作。</p> <p>注：任何类型的指针都可以转换为void* 指针</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//从src的起始位置赋值length个字节到dst的内存起始位置</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memmove</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memcmp</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memchr</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> ch<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memset</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> ch<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//这些函数整体功能和str系列函数差不多，但它们可以处理包括NULL字节在内的任意字节</span>
</code></pre></div><h2 id="警告的总结-7"><a href="#警告的总结-7" class="header-anchor">#</a> 警告的总结</h2> <p>1.应该使用有符号数的表达式中使用strlen函数。</p> <p>2.在表达式中混用有符号数和无符号数。</p> <p>3.使用strcpy函数把一个长字符串复制到一个较短的数组中，导致溢出。</p> <p>4.使用strcat函数把一个字符串添加到一个数组中，导致数组溢出。</p> <p>5.使用strcmp函数返回值当作布尔值进行测试。</p> <p>6.把strcmp函数的返回值与1和-1比较。</p> <p>7.使用并非以NULL字节结尾的字符序列。</p> <p>8.使用strncpy函数产生不以NULL字节结尾的字符串。</p> <p>9.把strncpy函数和strxxx族函数混用。</p> <p>10.忘了strtok函数将会修改它所处理的字符串。</p> <p>11.strtok函数是不可再入的。</p> <h2 id="编程提示总结-4"><a href="#编程提示总结-4" class="header-anchor">#</a> 编程提示总结</h2> <p>1.不要试图自己编写技能相同的函数来取代库函数。</p> <p>2.使用字符分类和转换函数可以提高函数的移植性。</p> <h1 id="_10、结构体和联合"><a href="#_10、结构体和联合" class="header-anchor">#</a> 10、结构体和联合</h1> <p>与数组不同，每个结构体成员都有自己的名字，它们都是通过名字访问的。</p> <h2 id="_10-1结构体基础"><a href="#_10-1结构体基础" class="header-anchor">#</a> 10.1结构体基础</h2> <h3 id="_10-1-1结构体声明"><a href="#_10-1-1结构体声明" class="header-anchor">#</a> 10.1.1结构体声明</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>x<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>y<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>z<span class="token punctuation">;</span>   <span class="token comment">//这种声明和上一个声明再编译器中是两种不同的类型，即			使它们的成员列表完全相同。</span>
<span class="token comment">//因此，z=&amp;x;  非法</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//利用标签创建变量</span>
<span class="token keyword">struct</span> <span class="token class-name">SIMPLE</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">SIMPLE</span> x<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">SIMPLE</span> y<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>z<span class="token punctuation">;</span>

<span class="token comment">//利用typedef</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Simple<span class="token punctuation">;</span>

Simple x<span class="token punctuation">;</span>
Simple y<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>z<span class="token punctuation">;</span>
</code></pre></div><h3 id="_10-1-3成员访问"><a href="#_10-1-3成员访问" class="header-anchor">#</a> 10.1.3成员访问</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Simple<span class="token punctuation">;</span>

<span class="token comment">//一般访问</span>
Simple x<span class="token punctuation">;</span>
x<span class="token punctuation">.</span>a<span class="token punctuation">;</span>
<span class="token comment">//指针访问</span>
Simple <span class="token operator">*</span>p<span class="token operator">=</span><span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span>a<span class="token punctuation">;</span>     p<span class="token operator">-&gt;</span>a<span class="token punctuation">;</span>
</code></pre></div><h3 id="_10-1-5结构体自引用"><a href="#_10-1-5结构体自引用" class="header-anchor">#</a> 10.1.5结构体自引用</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">SELF_REF</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">;</span>
	<span class="token keyword">int</span> c<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">SELF_REF</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>   
<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//自引用必须是指针而不是一般结构体，因为编译器再结构体的长度确定之前就已经知道指针的长度。</span>
</code></pre></div><h3 id="_10-1-6不完整声明"><a href="#_10-1-6不完整声明" class="header-anchor">#</a> 10.1.6不完整声明</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//构建两个互相引用的结构体</span>
<span class="token keyword">struct</span> <span class="token class-name">B</span><span class="token punctuation">;</span>  <span class="token comment">//不完整声明</span>
<span class="token keyword">struct</span> <span class="token class-name">A</span><span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">B</span> <span class="token operator">*</span>partner<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">B</span><span class="token punctuation">{</span>
	<span class="token keyword">struct</span> <span class="token class-name">A</span> <span class="token operator">*</span>partner<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_10-1-7结构体初始化"><a href="#_10-1-7结构体初始化" class="header-anchor">#</a> 10.1.7结构体初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">float</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Simple<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">INIT_EX</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">short</span> b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    Simple c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>x<span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token char">'x'</span><span class="token punctuation">,</span><span class="token number">1.9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_10-3结构的存储分配"><a href="#_10-3结构的存储分配" class="header-anchor">#</a> 10.3结构的存储分配</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">ALIGN</span><span class="token punctuation">{</span>
    <span class="token keyword">char</span> a<span class="token punctuation">;</span>
    <span class="token keyword">int</span> b<span class="token punctuation">;</span>
    <span class="token keyword">char</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//成员在编译时会按声明顺序进行存储</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/141678bd480d48ccb3648f5b301e9291.png#pic_center" loading="lazy" class="lazy">
显然，a后面会先浪费3个空间再存b，为了节省空间，可以如下声明</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">ALIGN</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> b
    <span class="token keyword">char</span> a；
    <span class="token keyword">char</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

<span class="token comment">//sizeof操作可以得出一个结构体的整体长度，包括上述浪费的空间。</span>

<span class="token comment">//如果必须确定结构某个成员的实际位置，可以使用offsetof宏(stddef.h)</span>
<span class="token function">offsetof</span><span class="token punctuation">(</span>type <span class="token punctuation">,</span> memeber<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//如 offsetof(struct ALIGN, b); 会返回b的首地址</span>
</code></pre></div><h2 id="_10-4作为函数参数"><a href="#_10-4作为函数参数" class="header-anchor">#</a> 10.4作为函数参数</h2> <p>若不使用指针传递，一个大体量的结构体的值传递将会花费较大资源拷贝一个备份传入堆栈，函数调用完之后又要删除，这样效率很低。</p> <p>推荐使用指针传递，为了防止结构体被修改，可以将指针引用声明为const。</p> <p>另外，还可以把参数声明为寄存器变量，从而进一步提高指针传递方案的效率。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">register</span> SIMPLE <span class="token keyword">const</span> <span class="token operator">*</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_10-5位段"><a href="#_10-5位段" class="header-anchor">#</a> 10.5位段</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//声明</span>
<span class="token keyword">struct</span> <span class="token class-name">CHAR</span><span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> ch		<span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> font	<span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> size	<span class="token operator">:</span><span class="token number">19</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">CHAR</span> ch1<span class="token punctuation">;</span>
<span class="token comment">//该结构体可以处理128(2^7)个不同的字符值、64(2^6)种不同的字体、0~524287个单位的长度。</span>

</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/dfc12bddf6db4a2e9a62a500cb192fd2.png#pic_center" loading="lazy" class="lazy">
另一个使用位段的理由就是它们可以很方便地访问一个整型值得部分内容。</p> <p>例：操作系统中，用于操作软盘的代码必须与磁盘控制器通信。这些设备控制器常常包含了几个寄存器，每个寄存器又包含了许多包装在一个整型值内的不同的值。位段就是一种方便访问这些单一值得方法。假定磁盘控制器其中一个寄存器是如下定义的：</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/05a40d45b9504366845c805038ae5167.png#pic_center" loading="lazy" class="lazy"></p> <p>前5个位段每个都占1位，其余几个位段更长一些。在一个从右向左分配位段的机器上，下面这个声明允许程序方便对这个寄存器的不同位段进行访问。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">DISK_REGISTER_FORMAT</span><span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> command		<span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> sector			<span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> track			<span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> error_code		<span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> head_loaded	<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> write_protect	<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> disk_spinning	<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> error_occurred	<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> ready			<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//假如磁盘寄存器是在内存地址0xc0200142进行访问的，我们可以声明下面的指针常量</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DISK_REGISTER</span> <span class="token punctuation">\</span>
	<span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">DISK_REGISTER_FORMAT</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0xc0200142</span><span class="token punctuation">)</span></span></span>

<span class="token comment">//告诉控制器从哪个扇区哪个磁道开始读取</span>
DISK_REGISTER<span class="token operator">-&gt;</span>sector<span class="token operator">=</span>new_sector<span class="token punctuation">;</span>
DISK_REGISTER<span class="token operator">-&gt;</span>track<span class="token operator">=</span>new_track<span class="token punctuation">;</span>
DISK_REGISTER<span class="token operator">-&gt;</span>command<span class="token operator">=</span>new_READ<span class="token punctuation">;</span>

<span class="token comment">//等待，知道操作完成(ready变量变成真)</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>DISK_REGISTER<span class="token operator">-&gt;</span>ready<span class="token punctuation">)</span>  <span class="token punctuation">;</span>

<span class="token comment">//检查错误</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>DISK_REGISTER<span class="token operator">-&gt;</span>error_occurred<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>DISK_REGISTER<span class="token operator">-&gt;</span>error_code<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">//赋值</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DISK_REGISTER</span> <span class="token expression"><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0xc0200142</span>  </span><span class="token comment">//与前一个define作用相同</span></span>
<span class="token operator">*</span>DICK_REGISTER <span class="token operator">&amp;=</span><span class="token number">0XFFFFFC1F</span><span class="token punctuation">;</span> <span class="token comment">//使用与操作把sector字段清零，但不影响其他字段</span>
<span class="token operator">*</span>DISK_REGISTER <span class="token operator">|=</span> <span class="token punctuation">(</span>new_sector <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//接受new_sector的值，&amp;确保这个值不会超过这个位段的宽度。接着，把它左移到合适的位置，然后再用 | 把这个字段设置为重要的值</span>
</code></pre></div><h2 id="_10-6联合"><a href="#_10-6联合" class="header-anchor">#</a> 10.6联合</h2> <p>目的：在<u>不同的时刻</u>把不同的东西存储在同一个位置。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">union</span><span class="token punctuation">{</span>
	<span class="token keyword">float</span> f<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>fi<span class="token punctuation">;</span>
<span class="token comment">//分配给联合的内存数量取决于它的最长成员的长度</span>
</code></pre></div><p>事实上，假如union的存储长度很长，但是某一时刻它实际存入的内容很短，这就会造成资源浪费。为了节省空间，可以让union存储不同类型的指针，所有指针的存储长度是相同的。</p> <h3 id="_10-6-2初始化"><a href="#_10-6-2初始化" class="header-anchor">#</a> 10.6.2初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">union</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">;</span>
	<span class="token keyword">float</span> b<span class="token punctuation">;</span>
	<span class="token keyword">char</span> c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>x<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//初始值必须是联合第1个成员的类型</span>
</code></pre></div><h2 id="警告的总结-8"><a href="#警告的总结-8" class="header-anchor">#</a> 警告的总结</h2> <p>1.具有相同成员列表的结构声明产生不同类型的变量。</p> <p>2.使用typedef位一个自引用的结构体定义名字时应该小心。</p> <p>3.向函数传递结构参数是低效的。</p> <h2 id="编程提示总结-5"><a href="#编程提示总结-5" class="header-anchor">#</a> 编程提示总结</h2> <p>1.把结构标签声明和结构的typedef声明放在头文件中，当源文件需要这些声明时可以通过#include进行引用。</p> <p>2.结构成员的最佳排列方式并不一定就是考虑边界对齐而浪费内存空间最少的那种排列形式(要在可读性和省空间之间有所权衡)。</p> <p>3.把位段成员显式地声明为signed int 或unsigned int 类型。</p> <p>4.位段是不可移植的。</p> <p>5.位段使源代码中位的操作表达得更为清楚。</p> <h1 id="_11、动态内存分配"><a href="#_11、动态内存分配" class="header-anchor">#</a> 11、动态内存分配</h1> <p>基本函数：malloc(分配内存)、free(释放内存)</p> <p>头文件：stdlib.h</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//分配一个指定大小的连续内存，若操作系统无法向malloc提供更多内存，malloc会返回NULL指针</span>
coid <span class="token function">free</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//参数要么是NULL，要么是先前从malloc、calloc、realloc返回的值</span>
</code></pre></div><h2 id="_11-3calloc和realloc"><a href="#_11-3calloc和realloc" class="header-anchor">#</a> 11.3calloc和realloc</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">calloc</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> num_elements<span class="token punctuation">,</span> <span class="token class-name">size_t</span> element_size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//返回的指针会顺便初始化</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">realloc</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> new_size<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//修改一个原先已经分配的内存块的大小</span>
</code></pre></div><h2 id="_11-4使用例"><a href="#_11-4使用例" class="header-anchor">#</a> 11.4使用例</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>pi<span class="token punctuation">;</span>
pi<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>pi<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//错误检查</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Out of memory.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//分配一个足够存储25个整数的内存</span>
pi<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//可移植</span>
<span class="token comment">//对pi既可以进行*pi++操作，还可以进行pi[i]操作</span>
</code></pre></div><h2 id="_11-5常见的动态内存错误"><a href="#_11-5常见的动态内存错误" class="header-anchor">#</a> 11.5常见的动态内存错误</h2> <p>错误分类：</p> <p>1.对NULL指针进行解引用。</p> <p>2.对分配的内存进行操作时越界。</p> <p>3.释放并非动态分配的内存。</p> <p>4.试图释放一块动态分配的内存的一部分。</p> <p>5.一块动态内存被释放之后被继续使用。</p> <div class="language-c extra-class"><pre class="language-c"><code>alloc<span class="token punctuation">.</span>h
<span class="token comment">//定义一个不易发生错误的内存分配器</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">malloc</span>     <span class="token comment">//不要直接调用malloc</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">MALLOC</span><span class="token expression"><span class="token punctuation">(</span>num <span class="token punctuation">,</span> type<span class="token punctuation">)</span>  <span class="token punctuation">(</span>type<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token keyword">extern</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//alloc可以调用malloc并进行检查，确保返回的指针不是NULL</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//接口</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;alloc.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">malloc</span></span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>new_mem<span class="token punctuation">;</span>
    <span class="token comment">//请求所需的内存，并检查确实分配成功</span>
    new_mem<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>new_mem<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Out of memory.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> new_mem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//实现</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;alloc.h&quot;</span></span>
<span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>new_memory<span class="token punctuation">;</span>
    <span class="token comment">//获得一串整型数的空间</span>
    new_memory<span class="token operator">=</span><span class="token function">MALLOC</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="不要访问被free释放的内存"><a href="#不要访问被free释放的内存" class="header-anchor">#</a> 不要访问被free释放的内存</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>q<span class="token operator">=</span>p<span class="token punctuation">;</span>
<span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//p释放后，q也不能再使用，除非改变了q的内容</span>
</code></pre></div><h4 id="内存泄漏"><a href="#内存泄漏" class="header-anchor">#</a> 内存泄漏</h4> <p>分配内存但在使用完毕后不释放将引起内存泄露(memory leak)。这会一点点榨干可用内存，除非重启系统。</p> <h2 id="警告的总结-9"><a href="#警告的总结-9" class="header-anchor">#</a> 警告的总结</h2> <p>1.不检查从malloc函数返回的指针是否为NULL。</p> <p>2.访问动态分配内存之外的区域。</p> <p>3.向free函数传递一个并非由malloc番薯返回的指针。</p> <p>4.在动态内存被释放之后再访问它。</p> <h2 id="编程提示总结-6"><a href="#编程提示总结-6" class="header-anchor">#</a> 编程提示总结</h2> <p>1.动态内存分配有助于消除程序内部存在的限制。</p> <p>2.使用sizeof计算出具类型的长度，提高程序的可移植性。</p> <h1 id="_12、使用结构和指针"><a href="#_12、使用结构和指针" class="header-anchor">#</a> 12、使用结构和指针</h1> <h2 id="_12-3双链表"><a href="#_12-3双链表" class="header-anchor">#</a> 12.3双链表</h2> <p>注：读代码时可以在草稿纸上模拟链表操作</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//双链表结点定义   doubly_linked_list_node.h</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">NODE</span><span class="token punctuation">{</span> 
    <span class="token keyword">struct</span> <span class="token class-name">NODE</span> <span class="token operator">*</span>fwd<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">NODE</span> <span class="token operator">*</span>bwd<span class="token punctuation">;</span>
    <span class="token keyword">int</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Node<span class="token punctuation">;</span>
</code></pre></div><h3 id="_12-3-1双链表插入操作的优化"><a href="#_12-3-1双链表插入操作的优化" class="header-anchor">#</a> 12.3.1双链表插入操作的优化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//一般的双链表插入函数</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;doubly_linked_list_node.h&quot;</span></span>
<span class="token keyword">int</span> <span class="token function">dll_insert</span><span class="token punctuation">(</span>Node <span class="token operator">*</span>rootp<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Node <span class="token operator">*</span>this<span class="token punctuation">;</span>
    Node <span class="token operator">*</span>next<span class="token punctuation">;</span>
    Node <span class="token operator">*</span>newnode<span class="token punctuation">;</span>
    <span class="token comment">/*
    	查看value是否已经存在于链表中，如果是就返回。
    	否则，为心的值创建一个新节点(newnode指向它)
    	&quot;this&quot;指向新节点之前的那个结点
    	&quot;next&quot;指向新节点之后的那个结点
    */</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>this<span class="token operator">=</span>rootp <span class="token punctuation">;</span> <span class="token punctuation">(</span>next<span class="token operator">=</span>this<span class="token operator">-&gt;</span>fwd<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>this<span class="token operator">=</span>next<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">-&gt;</span>value<span class="token operator">==</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">-&gt;</span>value<span class="token operator">&gt;</span>value<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    newnode<span class="token operator">=</span><span class="token punctuation">(</span>Node <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>newnode<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
    
    <span class="token comment">//把新值添加到链表中</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//情况1、2：并非位于链表尾部</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//情况1：并非位于链表起始位置</span>
            newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>next<span class="token punctuation">;</span>
            this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
            next<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>			<span class="token comment">//情况2：位于链表起始位置</span>
            newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>next<span class="token punctuation">;</span>
            rootp<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
            next<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">//情况3、4：位于链表尾部</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//情况3：并非位于链表起始位置</span>
            newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
            this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
            rootp<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>			<span class="token comment">//情况4：位于链表起始位置</span>
            newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
            rootp<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
            rootp<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>仔细分析可以发现，不同情况中存在相同的操作，可以进行提炼化简代码</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//第一次逻辑提炼</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//情况1、2：并非位于链表尾部</span>
        
        newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>next<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//情况1：并非位于链表起始位置</span>
            this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>			<span class="token comment">//情况2：位于链表起始位置</span>
            rootp<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    	next<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">//情况3、4：位于链表尾部</span>
        
        newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//情况3：并非位于链表起始位置</span>
            this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>			<span class="token comment">//情况4：位于链表起始位置</span>
            rootp<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        rootp<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>这个过程其实还可以简化。先看一个例子</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">if</span><span class="token punctuation">(</span>pointer <span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> field<span class="token operator">=</span>pointer<span class="token punctuation">;</span>
<span class="token keyword">else</span> field<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token comment">//上面的判断本质上等价于下句</span>
field<span class="token operator">=</span>pointer

<span class="token comment">//因此，之前代码的if(next != NULL)判断可以用这种方法化简</span>
newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>next<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span><span class="token punctuation">{</span>
    this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span><span class="token punctuation">{</span>
    rootp<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> next<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
<span class="token keyword">else</span> rootp<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//最终版本</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;doubly_linked_list_node.h&quot;</span></span>
<span class="token keyword">int</span> <span class="token function">dll_insert</span><span class="token punctuation">(</span>Node <span class="token operator">*</span>rootp<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">register</span> Node <span class="token operator">*</span>this<span class="token punctuation">;</span>
    <span class="token keyword">register</span> Node <span class="token operator">*</span>next<span class="token punctuation">;</span>
    <span class="token keyword">register</span> Node <span class="token operator">*</span>newnode<span class="token punctuation">;</span>
    <span class="token comment">/*
    	查看value是否已经存在于链表中，如果是就返回。
    	否则，为心的值创建一个新节点(newnode指向它)
    	&quot;this&quot;指向新节点之前的那个结点
    	&quot;next&quot;指向新节点之后的那个结点
    */</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>this<span class="token operator">=</span>rootp <span class="token punctuation">;</span> <span class="token punctuation">(</span>next<span class="token operator">=</span>this<span class="token operator">-&gt;</span>fwd<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>this<span class="token operator">=</span>next<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">-&gt;</span>value<span class="token operator">==</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">-&gt;</span>value<span class="token operator">&gt;</span>value<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    newnode<span class="token operator">=</span><span class="token punctuation">(</span>Node <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>newnode<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
    
    <span class="token comment">//把新值添加到链表中</span>
    newnode<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>next<span class="token punctuation">;</span>
    this<span class="token operator">-&gt;</span>fwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">!=</span>rootp<span class="token punctuation">)</span> newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>this<span class="token punctuation">;</span>
    <span class="token keyword">else</span> newnode<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> next<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    <span class="token keyword">else</span> rootp<span class="token operator">-&gt;</span>bwd<span class="token operator">=</span>newnode<span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="警告的总结-10"><a href="#警告的总结-10" class="header-anchor">#</a> 警告的总结</h2> <p>1.落到链表尾部的后面。</p> <p>2.使用指针时应格外小心，因为C并没有对它们的使用提供安全网。</p> <p>3.从if语句中提炼语句可能会改变测试结果。</p> <h2 id="编程提示的总结-5"><a href="#编程提示的总结-5" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.消除特殊情况使代码更易于维护。</p> <p>2.通过提炼语句消除if语句中的重复语句。</p> <p>3.不要仅仅根据代码的大小评估它的质量。</p> <h1 id="_13、高级指针话题"><a href="#_13、高级指针话题" class="header-anchor">#</a> 13、高级指针话题</h1> <h2 id="_13-2高级声明"><a href="#_13-2高级声明" class="header-anchor">#</a> 13.2高级声明</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//声明一个函数，它返回一个指向整型的指针</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//声明一个函数的指针，它指向的函数返回一个整型值</span>

<span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//和上一句相同，但必须对其进行间接访问操作才能得到整型值</span>

<span class="token keyword">int</span> <span class="token operator">*</span>f<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//f是一个数组，它的元素类型是指向整型的指针。</span>
<span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//f是一个函数，它的返回值是一个整型数组。不过这个声明是非法的，因为这里的函数只能返回标量值。</span>
<span class="token keyword">int</span> f<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//f是个数组，它的元素类型是返回值为整型的函数。这个声明也是非法的，因为数组元素必须有相同的长度。</span>

<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//这个声明是合法的。先求*f[]，f是一个元素为某种类型的指针的数组。然后看()号，说明f的数组元素是函数指针，这些指针所指向的函数的返回值是一个整型值</span>

<span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//与上一句同理，只是多了个间接访问符</span>


<span class="token comment">/*==============================================================*/</span>


<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>g<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//前者把f声明为一个函数指针，这个函数接受int和float两个类型的参数。</span>
<span class="token comment">//后者则是一个存函数指针的数组</span>
</code></pre></div><h2 id="_13-3函数指针"><a href="#_13-3函数指针" class="header-anchor">#</a> 13.3函数指针</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&amp;</span>f<span class="token punctuation">;</span>

<span class="token comment">//调用</span>
<span class="token keyword">int</span> ans<span class="token punctuation">;</span>
ans<span class="token operator">=</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ans<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ans<span class="token operator">=</span><span class="token function">pf</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_13-3-1回调函数"><a href="#_13-3-1回调函数" class="header-anchor">#</a> 13.3.1回调函数</h3> <p>向函数传递一个指向值的指针而不是值本身。函数有一个void* 形参，用于接收这个参数。  这样字符串和数组对象也可以被调用。字符串和数组无法作为参数传递给函数，但是指向它们的指针可以。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
	在一个单链表中查找一个指定值的函数，它的参数是一个指向链表第1个结点的指针，一个指向我们需要查找的值的指针和一个函数指针，它所指向的函数用于比较存储与链表中的类型的值。
*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;node.h&quot;</span></span>

Node<span class="token operator">*</span> <span class="token function">search_list</span><span class="token punctuation">(</span>Node <span class="token operator">*</span>node<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span>value<span class="token punctuation">.</span>
          <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>compare<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">const</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>node<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>node<span class="token operator">-&gt;</span>value<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        node<span class="token operator">=</span>node<span class="token operator">-&gt;</span>link<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> node<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//类型无关的链表查找</span>
</code></pre></div><h3 id="_13-1-2转换表"><a href="#_13-1-2转换表" class="header-anchor">#</a> 13.1.2转换表</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//简易计算器</span>
<span class="token keyword">switch</span><span class="token punctuation">(</span>oper<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> ADD<span class="token operator">:</span>
        result<span class="token operator">=</span><span class="token function">add</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> SUB<span class="token operator">:</span>
    	result<span class="token operator">=</span><span class="token function">sub</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> MUL<span class="token operator">:</span>
        result<span class="token operator">=</span><span class="token function">mul</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> DIV<span class="token operator">:</span>
        result<span class="token operator">=</span><span class="token function">div</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//函数声明</span>
<span class="token keyword">double</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">double</span> <span class="token punctuation">(</span><span class="token operator">*</span>oper_func<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span>
    add<span class="token punctuation">,</span>sub<span class="token punctuation">,</span>mul<span class="token punctuation">,</span>div<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//这一句可以取代一开始的switch语句</span>
result<span class="token operator">=</span>oper_func<span class="token punctuation">[</span>oper<span class="token punctuation">]</span><span class="token punctuation">(</span>op1<span class="token punctuation">,</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//oper从数组中选择正确的函数指针，而函数调用操作符将执行这个函数</span>
</code></pre></div><h2 id="_13-4命令行参数"><a href="#_13-4命令行参数" class="header-anchor">#</a> 13.4命令行参数</h2> <p>C的main函数有两个形参。第1个通常称为argc，它表示命令行参数的数目。第2个通常称为argv，它指向一组参数值的首元素。这些元素的每个都是指向一个参数文本的指针。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/88e9265027894b09b20bbc12a94ff49a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//处理命令行参数</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TRUE</span> <span class="token expression"><span class="token number">1</span></span></span>

<span class="token comment">//执行实际任务的函数的原型</span>
<span class="token keyword">void</span> <span class="token function">process_standard_input</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">process_file</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>file_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//选项标志，缺省初始化为FALSE</span>
<span class="token keyword">int</span> option_a<span class="token punctuation">,</span> option_b<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//处理选项参数:跳到下一个参数，并检查它是否以一个横杠开头</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">++</span>argv<span class="token operator">!=</span><span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token operator">==</span><span class="token char">'-'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//检查横杠后面的字母</span>
        <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">++</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token char">'a'</span><span class="token operator">:</span>
                option_a<span class="token operator">=</span>TRUE<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token char">'b'</span><span class="token operator">:</span>
                option_b<span class="token operator">=</span>TRUE<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//处理文件名参数</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>argv<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">process_standard_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">do</span><span class="token punctuation">{</span>
            <span class="token function">process_file</span><span class="token punctuation">(</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">++</span>argv<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/4834227285ee42b0be740071fbfaf504.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/e7184cea80084c7b836aa5ccec45e4be.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_13-5字符串常量"><a href="#_13-5字符串常量" class="header-anchor">#</a> 13.5字符串常量</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token string">&quot;xyz&quot;</span>     <span class="token comment">//这就是一个字符串常量，可以通过&quot;xyz&quot;[2]得到第3个字符</span>
<span class="token string">&quot;xyz&quot;</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token string">&quot;xyz&quot;</span><span class="token punctuation">;</span>   <span class="token comment">//返回'y'</span>

<span class="token function">putchar</span><span class="token punctuation">(</span><span class="token string">&quot;0123456789ABCDEF&quot;</span><span class="token punctuation">[</span>value<span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//使用余数作为下标打印指定位置的字符串</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//打印星号</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    n<span class="token operator">+=</span><span class="token number">5</span><span class="token punctuation">;</span>
    n<span class="token operator">/=</span><span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;**********&quot;</span><span class="token operator">+</span><span class="token number">10</span><span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="警告的总结-11"><a href="#警告的总结-11" class="header-anchor">#</a> 警告的总结</h2> <p>1.对一个未初始化的指针执行间接访问操作。</p> <p>2.在转移表中使用越界下标。</p> <h2 id="编程提示总结-7"><a href="#编程提示总结-7" class="header-anchor">#</a> 编程提示总结</h2> <p>1.如果并非必要，避免使用多层间接访问。</p> <p>2.cdecl程序可以帮助你分析复杂的声明。</p> <p>3.把void* 强制转换为其他类型的指针式必须小心。</p> <p>4.使用转移表时，应始终验证下标的有效性。</p> <p>5.破坏性的命令行参数处理方式会使你以后无法再次进行处理。</p> <p>6.不寻常的diamagnetic始终应该加上一条注释，描述它的目的和原理。</p> <h1 id="_14、预处理器"><a href="#_14、预处理器" class="header-anchor">#</a> 14、预处理器</h1> <h2 id="_14-1预定义符号"><a href="#_14-1预定义符号" class="header-anchor">#</a> 14.1预定义符号</h2> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/b4996750fa554fc3bb2cbdc3197506af.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="define"><a href="#define" class="header-anchor">#</a> #define</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">name</span> <span class="token expression">stuff</span></span>
<span class="token comment">//每当有符号name出现在这条指令后面使，预处理器就会把它替换成stuff</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">reg</span> <span class="token expression"><span class="token keyword">register</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">do_forever</span> <span class="token expression"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CASE</span> <span class="token expression"><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DEBUG_PRINT</span> <span class="token expression"><span class="token function">printf</span><span class="token punctuation">(</span></span><span class="token string">&quot;File %s line %d:&quot;</span><span class="token punctuation">\</span>
						<span class="token string">&quot;x=%d,y=%d,z=%d&quot;</span><span class="token expression"><span class="token punctuation">,</span></span><span class="token punctuation">\</span>
						<span class="token expression"><span class="token constant">__FILE__</span><span class="token punctuation">,</span><span class="token constant">__LINE__</span><span class="token punctuation">,</span></span><span class="token punctuation">\</span>
						<span class="token expression">x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span></span></span>
<span class="token comment">//内容过长可以用\代表分行</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">PROCESS_LOOP</span>  <span class="token punctuation">\</span>
	<span class="token expression"><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  </span><span class="token punctuation">\</span>
		<span class="token expression">sum<span class="token operator">+=</span>i<span class="token punctuation">;</span>			</span><span class="token punctuation">\</span>
		<span class="token expression"><span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> prod<span class="token operator">*=</span>i<span class="token punctuation">;</span>  </span><span class="token punctuation">\</span>
	<span class="token expression"><span class="token punctuation">}</span></span></span>
</code></pre></div><h3 id="_14-2-1宏"><a href="#_14-2-1宏" class="header-anchor">#</a> 14.2.1宏</h3> <p>把参数替换到文本中，这种实现叫做宏（macro）。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SQUARE</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    </span><span class="token comment">//宏不用分号结尾</span></span>
<span class="token function">SQUARE</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment">//会被替换成5*5</span>
    
<span class="token comment">//第一句若不写为(x)*(x)，则会出现问题，见下例</span>
<span class="token function">SQUARE</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token comment">//会替换成   a+1*a+1而不是(a+1)*(a+1)</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/cdefcd2dc8f047b49dbe42908a52bce3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_14-2-6-undef"><a href="#_14-2-6-undef" class="header-anchor">#</a> 14.2.6#undef</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">undef</span> <span class="token expression">name</span></span>
<span class="token comment">//如果一个现存的名字需要重新定义，那么它的旧定义首先必须用#undef移除</span>
</code></pre></div><h2 id="_14-3条件编译"><a href="#_14-3条件编译" class="header-anchor">#</a> 14.3条件编译</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">constant<span class="token operator">-</span>expression</span></span>
	statements
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">constant<span class="token operator">-</span>expression</span></span>
        other statements
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        other statements
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token comment">//如果常量表达式的值非零，那么statements部分会被正常编译，否则预处理器会删除它们</span>
</code></pre></div><h2 id="_14-3-1是否被定义"><a href="#_14-3-1是否被定义" class="header-anchor">#</a> 14.3.1是否被定义</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">symbol</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token operator">!</span><span class="token function">defined</span><span class="token punctuation">(</span>symbol<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">symbol</span></span>

<span class="token comment">//例</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">x<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">||</span> <span class="token function">defined</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">defined</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span></span></span>
</code></pre></div><h2 id="_14-4文件包含"><a href="#_14-4文件包含" class="header-anchor">#</a> 14.4文件包含</h2> <p>一个头文件如果被包含到10个源文件中，它实际上被编译了10次。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;filename&gt;</span>   <span class="token comment">//标准库文件</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&quot;filename&quot;</span>   <span class="token comment">//自定义头文件</span></span>
</code></pre></div><h4 id="避免多重包含"><a href="#避免多重包含" class="header-anchor">#</a> 避免多重包含</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_HEADERNAME_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_HEADERNAME_H</span> <span class="token expression"><span class="token number">1</span>  </span><span class="token comment">//如果头文件再次被包含，通过条件编译，它的所有内容被忽略</span></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment">//included filenames</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre></div><h2 id="_14-5其他指令"><a href="#_14-5其他指令" class="header-anchor">#</a> 14.5其他指令</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//#error</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">error</span> <span class="token expression">text of error message    </span><span class="token comment">//生成错误信息</span></span>

<span class="token comment">//例</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>OPTION_A<span class="token punctuation">)</span></span></span>
	stuff needed <span class="token keyword">for</span> option A
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>OPTION_B<span class="token punctuation">)</span></span></span>
	stuff needed <span class="token keyword">for</span> option B
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>OPTION_C<span class="token punctuation">)</span></span></span>
	stuff needed <span class="token keyword">for</span> option C
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
     <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">error</span> <span class="token expression">No option selected<span class="token operator">!</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
        
        
<span class="token comment">//#line</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">line</span> <span class="token expression">number </span><span class="token string">&quot;string&quot;</span></span>
<span class="token comment">//通知预处理器number是下一行输入的行号。如果给出了可选部分&quot;string&quot;，预处理器就把它作为当前文件的名字。</span>
        
        
<span class="token comment">//#progma   语法因编译器而异</span>
</code></pre></div><h2 id="警告的总结-12"><a href="#警告的总结-12" class="header-anchor">#</a> 警告的总结</h2> <p>1.不要在一个宏定义的末尾加上分号，使其称为一条完整的语句。</p> <p>2.在宏定义中使用参数，但忘了在它们周围加上括号。</p> <p>3.忘了在整个宏定义的两边加上括号。</p> <h2 id="编程提示的总结-6"><a href="#编程提示的总结-6" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.避免用#define指令定义可以用函数实现的很长序列的代码。</p> <p>2.在那些对表达式求值的宏中，每个宏参数出现的地方都应该加上括号，并且在整个宏定义的两边也加上括号。</p> <p>3.避免使用#define宏创建一种新语言。</p> <p>4.采用命名约定，使程序员很容易看出某个标识符是否为#define宏。</p> <p>5.只要合适就应该使用文件包含，不必担心它的额外开销。</p> <p>6.头文件只应该包含一组函数和(或)数据的声明。</p> <p>7.把不同集合的声明分离到不同的头文件中可以改善信息隐藏。</p> <p>8.嵌套的#include文件使我们很难判断源文件之间的依赖关系。</p> <h1 id="_15、输入-输出函数"><a href="#_15、输入-输出函数" class="header-anchor">#</a> 15、输入/输出函数</h1> <h2 id="_15-1错误报告"><a href="#_15-1错误报告" class="header-anchor">#</a> 15.1错误报告</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//stdio.h</span>
<span class="token keyword">void</span> <span class="token function">perror</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//如果message不是NULL并且指向一个非空的字符串，perror函数就打印出这个字符串，后面跟一个分号和一个空格，然后打印出一条用于解释errno当前错误代码的信息</span>
<span class="token comment">//只有当一个库函数失败时，errno才会被设置。因此，只有当被调用的函数提示有错误发生时检查errno的值才有意义</span>
</code></pre></div><h2 id="_15-2终止执行"><a href="#_15-2终止执行" class="header-anchor">#</a> 15.2终止执行</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//stdlib.h</span>
<span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//直接结束程序，status参数返回给操作系统，用于提示程序是否正常完成</span>
</code></pre></div><h2 id="_15-4-ansi-i-o概念"><a href="#_15-4-ansi-i-o概念" class="header-anchor">#</a> 15.4 ANSI I/O概念</h2> <h3 id="_15-4-1流"><a href="#_15-4-1流" class="header-anchor">#</a> 15.4.1流</h3> <p>ANSI C 中。所有的I/O操作只是简单地从程序移进或移出字节的事情。这种字节流被称为流。</p> <p>绝大多数流时完全缓冲的，这说明&quot;读取&quot;和&quot;写入&quot;实际上是从一块被称为缓冲区的内存区域来回复制数据。</p> <p>用于输出流的缓冲区只有当它写满是才会被刷新(flush, 物理写入)到设备或文件中。 一次性把写满的缓冲区写入和逐片把程序产生的输出分别写入相比效率更高。类似，输入缓冲区当它为空时通过从设备或文件读取下一块较大的输入，重新填充缓冲区。</p> <h3 id="_15-4-2文件"><a href="#_15-4-2文件" class="header-anchor">#</a> 15.4.2文件</h3> <p>stdio.h中定义了FILE结构，用于访问一个流。</p> <p>对于每个ANSI C程序，运行时必须提供至少三个流：标准输入(standard input)、标准输出(standard output)和标准错误(standard error)。这些流的名字分别为stdin、stdout、stderr，它们都是一个指向FILE结构的指针。</p> <h3 id="_15-4-3标准i-o常量"><a href="#_15-4-3标准i-o常量" class="header-anchor">#</a> 15.4.3标准I/O常量</h3> <p>FOPRN_MAX定义了至少能同时打开多少文件。</p> <p>FILENAME_MAX用于提示一个字符数组应该多大以便容纳编译器所支持的最长合法文件名</p> <h2 id="_15-5流i-o总览"><a href="#_15-5流i-o总览" class="header-anchor">#</a> 15.5流I/O总览</h2> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/c2d2ae90eef6470295b8204d9d414ccc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/84428521ae904aadb5f267d295b0ef61.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_15-6打开流"><a href="#_15-6打开流" class="header-anchor">#</a> 15.6打开流</h2> <div class="language-c extra-class"><pre class="language-c"><code>FILE <span class="token operator">*</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>name<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//第一个参数是相关的文件名，第二个参数是提示流是用于只读、只写还是读写</span>
<span class="token comment">//每次调用这个函数时最好都检查一下它的返回值</span>
FILE <span class="token operator">*</span>input<span class="token punctuation">;</span>
input<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;data3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>input<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;data3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><table><thead><tr><th></th> <th>读取</th> <th>写入</th> <th>添加</th></tr></thead> <tbody><tr><td>文本</td> <td>&quot;r&quot;</td> <td>&quot;w&quot;</td> <td>&quot;a&quot;</td></tr> <tr><td>二进制</td> <td>&quot;rb&quot;</td> <td>&quot;wb&quot;</td> <td>&quot;ab&quot;</td></tr></tbody></table> <div class="language-c extra-class"><pre class="language-c"><code>FILE <span class="token operator">*</span><span class="token function">freopen</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>filename<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>mode<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这个函数首先试图关闭这个流，然后用指定的文件和模式重新打开这个流。如果打开失败，函数返回一个NULL值。反之，返回它的第3个参数值。</span>
</code></pre></div><h2 id="_15-7关闭流"><a href="#_15-7关闭流" class="header-anchor">#</a> 15.7关闭流</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fclose</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//对于输出流，该函数在文件关闭之前刷新缓冲区。成功则返回零值，反之返回EOF</span>
</code></pre></div><h2 id="_15-8字符i-o"><a href="#_15-8字符i-o" class="header-anchor">#</a> 15.8字符I/O</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//获取字符</span>
<span class="token keyword">int</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//输出字符</span>
<span class="token keyword">int</span> <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token keyword">int</span> character<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">putc</span><span class="token punctuation">(</span><span class="token keyword">int</span> character<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token keyword">int</span> cahracter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//撤销字符</span>
<span class="token keyword">int</span> <span class="token function">ungetc</span><span class="token punctuation">(</span><span class="token keyword">int</span> character<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//把一串从标准输入读取的数字转换为整数</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;ctype.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">read_int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ch<span class="token punctuation">;</span>
    
    <span class="token comment">//转换从标准输入读取的数字，当我们得到一个非数字字符时就停止</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isdigit</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        value<span class="token operator">*=</span><span class="token number">10</span><span class="token punctuation">;</span>
        value<span class="token operator">+=</span>ch<span class="token operator">-</span><span class="token char">'0'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//把非数字字符退回到流中，这样它就不会丢失</span>
    <span class="token function">ugetc</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//如果用fseek、fsetpos或rewind函数改变了流的位置，所有退回的字符都将被丢弃</span>
</code></pre></div><h2 id="_15-9未格式化的行i-o"><a href="#_15-9未格式化的行i-o" class="header-anchor">#</a> 15.9未格式化的行I/O</h2> <p>未格式化的I/O简单读取或写入字符。而格式化的I/O则执行数字和其他变量的内部和外部表示形式之间的转换。</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//把标准输入读取的文本行逐行复制到标准输出</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_LINE_LENGTH</span> <span class="token expression"><span class="token number">1024</span></span></span>

<span class="token keyword">void</span> <span class="token function">copylines</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>input<span class="token punctuation">.</span> FILE <span class="token operator">*</span>output<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span>MAX_LINE_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span>MAX_LINE_LENGTH<span class="token punctuation">,</span>input<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token function">fputs</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15-10格式化的行i-o"><a href="#_15-10格式化的行i-o" class="header-anchor">#</a> 15.10格式化的行I/O</h2> <h2 id="_15-10-1-scanf族"><a href="#_15-10-1-scanf族" class="header-anchor">#</a> 15.10.1 scanf族</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fscanf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sscanf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>string<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这些函数都从输入源读取字符并根据format字符串给出的格式化代码对它们进行转换</span>


<span class="token comment">//使用例</span>
nfields<span class="token operator">=</span><span class="token function">fscanf</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span><span class="token string">&quot;%4d %4d %4d&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这个宽度参数把整数值的宽度限制为4个数字或更少。</span>
<span class="token comment">//输入 1  2 。  此时a=1,b=2,c不变,nfields=2.</span>
<span class="token comment">//输入 12345 67890。 此时a=1234,b=5,c=6789,nfields=3</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/a8611cd67cf44746a28ef2c17b832cb4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//用sscanf处理行定向(line-oriented)的输入</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BUFFER_SIZE</span> <span class="token expression"><span class="token number">100</span></span></span>

<span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>input<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>e<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span>BUFFER_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span>BUFFER_SIZE<span class="token punctuation">,</span>input<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sscanf</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;%d %d %d %d %d&quot;</span><span class="token punctuation">,</span>
                 <span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span><span class="token operator">&amp;</span>d<span class="token punctuation">,</span><span class="token operator">&amp;</span>e<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            		<span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span><span class="token string">&quot;Bad input skipped: %s&quot;</span><span class="token punctuation">,</span>
                            buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            		<span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//处理输入</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//使用sscanf处理可变格式的输入</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DEFAULT_A</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DEFAULT_B</span> <span class="token expression"><span class="token number">2</span></span></span>

<span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>buffer<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">;</span>
    <span class="token comment">//查看3个值是否都已经给出</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sscanf</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;%d %d %d&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//否，对a使用缺省值，看看其他两个值是否已经给出</span>
        a<span class="token operator">=</span>DEFAULT_A<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sscanf</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;%d %d&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//为b使用缺省值，寻找剩余的值</span>
            b<span class="token operator">=</span>DEFAULT_B<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sscanf</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span><span class="token string">&quot;$d&quot;</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span><span class="token string">&quot;Bad input: %s&quot;</span><span class="token punctuation">,</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_FAILURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//处理a,b,c</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_15-10-3-printf族"><a href="#_15-10-3-printf族" class="header-anchor">#</a> 15.10.3 printf族</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/ce890255007c49239b452f6495e403ad.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/3970b1b5dd344867b55c9cafa3a215ec.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_15,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/3e100005d3dd47909168b415fc412e1f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_19,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_15-11二进制i-o"><a href="#_15-11二进制i-o" class="header-anchor">#</a> 15.11二进制I/O</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token class-name">size_t</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">size_t</span> <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> count<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//buffer时一个指向用于保存数据的内存位置的指针，size时缓冲区中每个元素的字节数，count时读取或写入的元素数</span>
</code></pre></div><h2 id="_15-12刷新和定位函数"><a href="#_15-12刷新和定位函数" class="header-anchor">#</a> 15.12刷新和定位函数</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">fflush</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//该函数迫使输出流的缓冲区内的数据进行物理写入，不管它是否已满</span>

<span class="token comment">//随机访问I/O</span>
<span class="token keyword">long</span> <span class="token function">ftell</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//返回流当前的位置</span>
<span class="token keyword">int</span> <span class="token function">fseek</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">long</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//改变读写位置</span>
</code></pre></div><table><thead><tr><th>如果from是...</th> <th>你将定位到</th></tr></thead> <tbody><tr><td>SEEK_SET</td> <td>从流的起始位置起offset个字节，offset必须是一个非负值。</td></tr> <tr><td>SEEK_CUR</td> <td>从流的当前位置起offset个字节，offset可正可负。</td></tr> <tr><td>SEEK_END</td> <td>从流的尾部位置起offset个字节，offset可正可负。如果为正，它将定位到文件尾的后面</td></tr></tbody></table> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">rewind</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//rewind将读/写指针设置回指定流的起始位置。同时清除流的错误提示信息</span>
<span class="token keyword">int</span> <span class="token function">fgetpos</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token class-name">fpos_t</span> <span class="token operator">*</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fsetpos</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token class-name">fpos_t</span> <span class="token keyword">const</span> <span class="token operator">*</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//后两个函数是rewind的替代方案</span>
</code></pre></div><h2 id="_15-13改变缓冲方式"><a href="#_15-13改变缓冲方式" class="header-anchor">#</a> 15.13改变缓冲方式</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">setbuf</span><span class="token punctuation">(</span>FILE<span class="token operator">*</span> stream<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//setbuf设置了另一个数组，用于对流进行缓冲</span>
<span class="token keyword">int</span> <span class="token function">setvbuf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">,</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//mode参数用于指定缓冲的类型。_IOFBF指定一个完全缓冲的流，_IONBF指定一个不缓存的流，_IOLBF指定一个行缓冲流。</span>
</code></pre></div><h3 id="_15-14流错误函数"><a href="#_15-14流错误函数" class="header-anchor">#</a> 15.14流错误函数</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//判断流的状态</span>
<span class="token keyword">int</span> <span class="token function">feof</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//如果流当前处于文件尾，feof返回真。这个状态可以通过对流执行feseek、rewind或fsetpos函数来清除</span>

<span class="token keyword">int</span> <span class="token function">ferror</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ferror报告流的错误状态，如果出现任何读写错误就返回真</span>
<span class="token keyword">void</span> <span class="token function">clearerr</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//clearerr对指定流的错误标志进行重置</span>
</code></pre></div><h2 id="_15-15临时文件"><a href="#_15-15临时文件" class="header-anchor">#</a> 15.15临时文件</h2> <div class="language-c extra-class"><pre class="language-c"><code>FILE <span class="token operator">*</span><span class="token function">tmpfile</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个文件，当文件被关闭或程序终止时这个文件会自动删除</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">tmpnam</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//给临时文件起名</span>
</code></pre></div><h2 id="_15-16-文件操纵函数"><a href="#_15-16-文件操纵函数" class="header-anchor">#</a> 15.16 文件操纵函数</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//删除一个指定文件</span>
<span class="token keyword">int</span> <span class="token function">rename</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>oldname<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>newname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//重命名指定文件</span>
</code></pre></div><h2 id="警告的总结-13"><a href="#警告的总结-13" class="header-anchor">#</a> 警告的总结</h2> <p>1.忘了在一条调试用的printf语句后跟一个fflush调用。</p> <p>2.不检查fopen函数的返回值。</p> <p>3.改变文件的位置将丢弃任何被退回到流的字符。</p> <p>4.在使用fgets时指定太小的缓冲区。</p> <p>5.使用gets的输入溢出缓冲区且违背检测到。</p> <p>6.使用任何scanf/printf系列函数时，格式代码和参数指针类型不匹配。</p> <p>7.在任何scanf系列函数的每个非数组、非指针参数前忘了加上&amp;符号。</p> <p>8.注意在使用scanf系列函数转换double、long double、short和long整型时，在格式化代码中加上合适的限定符。</p> <p>9.sprintf函数的输出溢出了，且缓冲区未检测到。</p> <p>10.混淆printf和scanf格式代码。</p> <p>11.在有些长整数长于普通整数的机器上打印长整数值时，忘了在格式代码中指定l修改符。</p> <p>12.使用自动数组作为流的缓冲区时多加小心。</p> <h2 id="编程提示总结-8"><a href="#编程提示总结-8" class="header-anchor">#</a> 编程提示总结</h2> <p>1.在可能出现错误的场合，检查并报告错误。</p> <p>2.操纵文本行而无需顾及它们的外部表示形式，这有助于提高程序的可移植性。</p> <p>3.使用scanf限定符提高可移植性。</p> <p>4.当你打印长整数时，即使你所使用的机器并不重要，坚实使用l修改符可以提高可移植性。</p> <h1 id="_16、标准函数库"><a href="#_16、标准函数库" class="header-anchor">#</a> 16、标准函数库</h1> <p>按需学习，可以直接参考官方文档</p> <h2 id="警告的总结-14"><a href="#警告的总结-14" class="header-anchor">#</a> 警告的总结</h2> <p>1.忘了包含math.h头文件导致数学函数产生错误结果。</p> <p>2.clock函数可能只产生处理器时间的近似值。</p> <p>3.time函数的返回值并不一定是以秒为单位的。</p> <p>4.longjmp不能返回到一个已经不在处于活动状态的函数。</p> <p>5.避免exit函数的多重调用。</p> <h2 id="编程提示总结-9"><a href="#编程提示总结-9" class="header-anchor">#</a> 编程提示总结</h2> <p>1.滥用setjmp和longjmp可能导致晦涩难懂的代码。</p> <p>2.对信号进行处理将导致程序的可移植性变差。</p> <p>3.使用断言可以简化程序的调试。</p> <h1 id="_17、经典抽象数据类型"><a href="#_17、经典抽象数据类型" class="header-anchor">#</a> 17、经典抽象数据类型</h1> <h2 id="_17-1堆栈"><a href="#_17-1堆栈" class="header-anchor">#</a> 17.1堆栈</h2> <h3 id="接口"><a href="#接口" class="header-anchor">#</a> 接口</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//stack.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STACK_TYPE</span> <span class="token expression"><span class="token keyword">int</span>  </span><span class="token comment">//堆栈存储的值的类型</span></span>

<span class="token comment">/*
push
把一个新值压入栈中
*/</span>
<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>STACK_TYPE value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
pop
弹出栈顶的值
*/</span>
<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
top
返回栈顶值
*/</span>
STACK_TYPE <span class="token function">top</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
is_empty
判断栈是否为空
*/</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
is_full
判断栈是否已满
*/</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_17-1-1静态数组实现"><a href="#_17-1-1静态数组实现" class="header-anchor">#</a> 17.1.1静态数组实现</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
	用一个静态数组实现堆栈，数组的长度只能通过修改#define定义
	并对模块重新进行编译实现
*/</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&quot;stack.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STACK_SIZE</span> <span class="token expression"><span class="token number">100</span>   </span><span class="token comment">//栈的规模</span></span>

<span class="token comment">//存储栈中值得数组和一个指向栈顶元素得指针</span>
<span class="token keyword">static</span> STACK_TYPE stack<span class="token punctuation">[</span>STACK_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span>    top_element<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">//push</span>
<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>STACK_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    top_element<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
    stack<span class="token punctuation">[</span>top_element<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//pop</span>
<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    top_element<span class="token operator">-=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//top</span>
STACK_TYPE <span class="token function">top</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> stack<span class="token punctuation">[</span>top_element<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_empty</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> top_element<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_full</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> top_element<span class="token operator">==</span>STACK_SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_17-1-2动态数组实现"><a href="#_17-1-2动态数组实现" class="header-anchor">#</a> 17.1.2动态数组实现</h3> <p>先在stack.h文件中加入以下接口</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
create_stack
创建堆栈，参数指定堆栈可以保存多少元素
*/</span>
<span class="token keyword">void</span> <span class="token function">create_stack</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
destory_stack
销毁堆栈，释放内存
*/</span>
<span class="token keyword">void</span> <span class="token function">destory_stack</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">/*
一个用动态分配数组实现得堆栈
堆栈的长度在创建时给出
*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&quot;stack.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;malloc.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token comment">//用于存储栈元素的数组和指向堆栈顶部元素的指针</span>
<span class="token keyword">static</span> STACK_TYPE <span class="token operator">*</span>stack<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token class-name">size_t</span> stack_size<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> top_element<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">//create_stack</span>
<span class="token keyword">void</span> <span class="token function">create_stack</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>stack_size<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stack_size<span class="token operator">=</span>size<span class="token punctuation">;</span>
    stack<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span>stack_size<span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>STACK_TYPE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>stack<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//destory_stack</span>
<span class="token keyword">void</span> <span class="token function">destory_stack</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>stack_size<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stack_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
    stack<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//push</span>
<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>STACK_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    top_element<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
    stack<span class="token punctuation">[</span>top_element<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//pop</span>
<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    top_element<span class="token operator">-=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//top</span>
STACK_TYPE <span class="token function">top</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> stack<span class="token punctuation">[</span>top_element<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_empty</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> top_element<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_full</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> top_element<span class="token operator">==</span>stack_size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_17-1-3链式堆栈"><a href="#_17-1-3链式堆栈" class="header-anchor">#</a> 17.1.3链式堆栈</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//链表实现栈，这个栈没有长度限制</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&quot;stack.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;malloc.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FALSE</span> <span class="token expression"><span class="token number">0</span></span></span>

<span class="token comment">//定义一个结构体来存储栈元素，next字段指向下一个元素</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">STACK_NODE</span><span class="token punctuation">{</span>
    STACK_TYPE value<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">STACK_NODE</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> StackNode <span class="token operator">*</span>stack<span class="token punctuation">;</span>


<span class="token comment">//create_stack</span>
<span class="token keyword">void</span> <span class="token function">create_stack</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">//destory_stack</span>
<span class="token keyword">void</span> <span class="token function">destory_stack</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//push</span>
<span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span>STACK_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    StackNode <span class="token operator">*</span>new_node<span class="token punctuation">;</span>
    
    new_node<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>StackNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>new_node<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    new_node<span class="token operator">-&gt;</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
    new_node<span class="token operator">-&gt;</span>next<span class="token operator">=</span>stack<span class="token punctuation">;</span>
    stack<span class="token operator">=</span>new_node<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//pop</span>
<span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    StackNode <span class="token operator">*</span>first_node<span class="token punctuation">;</span>
    
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    first_node<span class="token operator">=</span>stack<span class="token punctuation">;</span>
    stack<span class="token operator">=</span>first_node<span class="token operator">-&gt;</span>next<span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>first_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//top</span>
STACK_TYPE <span class="token function">top</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> stack<span class="token operator">-&gt;</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_empty</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> stack<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_full</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_17-2队列"><a href="#_17-2队列" class="header-anchor">#</a> 17.2队列</h2> <h3 id="接口-2"><a href="#接口-2" class="header-anchor">#</a> 接口</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//queue.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">QUEUE_TYPE</span> <span class="token expression"><span class="token keyword">int</span> </span><span class="token comment">//队列元素类型</span></span>

<span class="token comment">/*
create_queue
创建一个队列，参数指定队列最大容量
*/</span>
<span class="token keyword">void</span> <span class="token function">create_queue</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
destory_queue
销毁一个队列
*/</span>
<span class="token keyword">void</span> <span class="token function">destory_queue</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
insert
向队列添加一个新元素
*/</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>QUEUE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
delete
从队列中删除一个元素
*/</span>
<span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
first
返回队头
*/</span>
QUEUE_TYPE <span class="token function">first</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
is_empty
判断队列是否为空
*/</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
is_full
判断队列是否已满
*/</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_17-2-1静态数组实现"><a href="#_17-2-1静态数组实现" class="header-anchor">#</a> 17.2.1静态数组实现</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//用静态数组实现队列</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;queue.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">QUEUE_SIZE</span> <span class="token expression"><span class="token number">100</span> </span><span class="token comment">//队列中元素的最大数量</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ARRAY_SIZE</span> <span class="token expression"><span class="token punctuation">(</span>QUEUE_SIZE <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> </span><span class="token comment">//数组长度</span></span>

<span class="token comment">//存储队里了元素的数组和指向队列头和尾的指针</span>
<span class="token keyword">static</span> QUEUE_TYPE queue<span class="token punctuation">{</span>ARRAY_SIZE<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token class-name">size_t</span> front<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token class-name">size_t</span> rear<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">//insert</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>QUEUE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_full</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rear<span class="token operator">=</span><span class="token punctuation">(</span>rear<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>ARRAY_SIZE<span class="token punctuation">;</span>
    queue<span class="token punctuation">[</span>rear<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//delete</span>
<span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    front<span class="token operator">=</span><span class="token punctuation">(</span>front<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>ARRAY_SIZE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//first</span>
QUEUE_TYPE <span class="token function">first</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> queue<span class="token punctuation">[</span>front<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_empty</span>
<span class="token keyword">int</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>rear<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>ARRAY_SIZE<span class="token operator">==</span>front<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//is_full</span>
<span class="token keyword">int</span> <span class="token function">is_full</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>rear<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">%</span>ARRAY_SIZE<span class="token operator">==</span>front<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_17-3树"><a href="#_17-3树" class="header-anchor">#</a> 17.3树</h2> <h3 id="接口-3"><a href="#接口-3" class="header-anchor">#</a> 接口</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//tree.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TREE_TYPE</span> <span class="token expression"><span class="token keyword">int</span>  </span><span class="token comment">//树的值类型</span></span>

<span class="token comment">/*
insert
向树添加一个值，这个值原先不存在树中
*/</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
find
查找一个特定的值
*/</span>
TREE_TYPE <span class="token operator">*</span><span class="token function">find</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
pre_order_traverse
先序遍历
*/</span>
<span class="token keyword">void</span> <span class="token function">pre_order_traverse</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>callback<span class="token punctuation">)</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_17-3-1静态数组实现"><a href="#_17-3-1静态数组实现" class="header-anchor">#</a> 17.3.1静态数组实现</h2> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//静态数组实现二叉搜索树</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;tree.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TREE_SIZE</span> <span class="token expression"><span class="token number">100</span>  </span><span class="token comment">//树的规模</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ARRAY_SIZE</span>  <span class="token expression"><span class="token punctuation">(</span>TREE_SIZE<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></span></span>

<span class="token comment">//用于存储树所有节点的数组</span>
<span class="token keyword">static</span> TREE_TYPE tree<span class="token punctuation">[</span>ARRAY_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/*
left_child
计算一个节点左孩子的下标
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">left_child</span><span class="token punctuation">(</span><span class="token keyword">int</span> current<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> current<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
right_child
计算一个节点右孩子的下标
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">right_child</span><span class="token punctuation">(</span><span class="token keyword">int</span> current<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> current<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//insert</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> current<span class="token punctuation">;</span>
    <span class="token comment">//从根节点开始，直到找到那个值，进入合适的子树</span>
    current<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token keyword">while</span><span class="token punctuation">(</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//根据情况，进入左子树或右子树(确信未出现重复的值)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">&lt;</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span>
            current<span class="token operator">=</span><span class="token function">left_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">assert</span><span class="token punctuation">(</span>value<span class="token operator">!=</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            current<span class="token operator">=</span><span class="token function">right_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">assert</span><span class="token punctuation">(</span>current<span class="token operator">&lt;</span>ARRAY_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//find</span>
TREE_TYPE <span class="token operator">*</span><span class="token function">find</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> current<span class="token punctuation">;</span>
    <span class="token comment">//确保值非零，因为零用于提示一个未使用的节点</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>value<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//从根节点开始</span>
    current<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token comment">//从合适的子树开始，直到到达一个叶节点</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>current<span class="token operator">&lt;</span>ARRAY_SIZE <span class="token operator">&amp;&amp;</span> tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">!=</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//根据情况，进入左子树或右子树</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">&lt;</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span>
            current<span class="token operator">=</span><span class="token function">left_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            current<span class="token operator">=</span><span class="token function">right_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>current<span class="token operator">&lt;</span>ARRAY_SIZE<span class="token punctuation">)</span> <span class="token keyword">return</span> tree<span class="token operator">+</span>current<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/*
do_pre_order_traverse
执行一层先序遍历，这个辅助函数用于保存我们当前正在处理的节点信息
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> current<span class="token punctuation">,</span>
                   <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>callback<span class="token punctuation">)</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>current<span class="token operator">&lt;</span>ARRAY_SIZE <span class="token operator">&amp;&amp;</span> tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span><span class="token function">left_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span><span class="token function">right_child</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//pre_order_traverse</span>
<span class="token keyword">void</span> <span class="token function">pre_order_traverse</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>callback<span class="token punctuation">)</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_17-3-2链表实现"><a href="#_17-3-2链表实现" class="header-anchor">#</a> 17.3.2链表实现</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//链表实现树</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;tree.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;malloc.h&gt;</span></span>

<span class="token comment">//TreeNode结构包含了值和两个指向某个树节点的指针</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">TREE_NODE</span><span class="token punctuation">{</span>
    TREE_TYPE value<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">TREE_NODE</span> <span class="token operator">*</span>left<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">TREE_NODE</span> <span class="token operator">*</span>right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>TreeNode<span class="token punctuation">;</span>

<span class="token comment">//指向树根节点的指针</span>
<span class="token keyword">static</span> TreeNode <span class="token operator">*</span>tree<span class="token punctuation">;</span>

<span class="token comment">//insert</span>
<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    TreeNode <span class="token operator">*</span>current<span class="token punctuation">;</span>
    TreeNode <span class="token operator">*</span><span class="token operator">*</span>link<span class="token punctuation">;</span>
    
    <span class="token comment">//从根节点开始</span>
    link<span class="token operator">=</span><span class="token operator">&amp;</span>tree<span class="token punctuation">;</span>
    <span class="token comment">//持续查找值，进入合适的子树</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>current<span class="token operator">=</span><span class="token operator">*</span>link<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//根据情况，进入左子树或右子树(确认无重复值)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">&lt;</span>current<span class="token operator">-&gt;</span>value<span class="token punctuation">)</span> link<span class="token operator">=</span><span class="token operator">&amp;</span>current<span class="token operator">-&gt;</span>left<span class="token punctuation">;</span>
        <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">assert</span><span class="token punctuation">(</span>value<span class="token operator">!=</span>current<span class="token operator">-&gt;</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            link<span class="token operator">=</span><span class="token operator">&amp;</span>current<span class="token operator">-&gt;</span>right<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//分配一个新节点，使适当节点的link字段指向它</span>
    current<span class="token operator">=</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>TreeNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>current<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    current<span class="token operator">-&gt;</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
    current<span class="token operator">-&gt;</span>left<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    current<span class="token operator">-&gt;</span>right<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>link<span class="token operator">=</span>current<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//find</span>
TREE_TYPE <span class="token operator">*</span><span class="token function">find</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    TreeNode <span class="token operator">*</span>current<span class="token punctuation">;</span>
    
    <span class="token comment">//从根节点开始</span>
    current<span class="token operator">=</span>tree<span class="token punctuation">;</span>
    
    <span class="token comment">//从合适的子树开始，直到到达一个叶节点</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>current<span class="token operator">!=</span><span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> current<span class="token operator">-&gt;</span>value<span class="token operator">!=</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//根据情况，进入左子树或右子树</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">&lt;</span>current<span class="token operator">-&gt;</span>value<span class="token punctuation">)</span>
            current<span class="token operator">=</span>current<span class="token operator">-&gt;</span>left<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            current<span class="token operator">=</span>current<span class="token operator">-&gt;</span>right<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>current<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">&amp;</span>current<span class="token operator">-&gt;</span>value<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
do_pre_order_traverse
执行一层先序遍历，这个辅助函数用于保存我们当前正在处理的节点信息
*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span>TreeNode <span class="token operator">*</span>current<span class="token punctuation">,</span>
                   <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>callback<span class="token punctuation">)</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>current<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span>tree<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span>current<span class="token operator">-&gt;</span>left<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span>current<span class="token operator">-&gt;</span>right<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//pre_order_traverse</span>
<span class="token keyword">void</span> <span class="token function">pre_order_traverse</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>callback<span class="token punctuation">)</span><span class="token punctuation">(</span>TREE_TYPE value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token function">do_pre_order_traverse</span><span class="token punctuation">(</span>tree<span class="token punctuation">,</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_17-4-实现的改进"><a href="#_17-4-实现的改进" class="header-anchor">#</a> 17.4 实现的改进</h2> <p>1.有时可能会拥有超过一个的堆栈。</p> <p>可以从堆栈的实现模块中取出数组和top_element的声明，并把它们放入用户代码。</p> <p>然后，它们通过参数被堆栈函数访问，这些函数便不再固定于某个数组。缺点是这样会丢失封装性，造成非法访问。</p> <p>2.拥有超过一个类型</p> <p>有时可能同时需要一个整型栈和一个浮点型栈。</p> <p>可以把整个堆栈模块实现为一个#define宏，把目标类型作为参数。</p> <p>还可以让它存储void* 类型的值，绕过类型检查。但是很容易出错。如：一个整数被压入一个元素类型为指针的栈中。</p> <p>可以设计一个泛型ADT。</p> <p>3.名字冲突</p> <h2 id="警告的总结-15"><a href="#警告的总结-15" class="header-anchor">#</a> 警告的总结</h2> <p>1.不要使用断言检查内存是否分配成功。</p> <p>2.数组形式的二叉树节点位置计算公式假定数组的下标从1开始。</p> <p>3.把数据封装于对它进行操纵的模块可以防止用户不正确地访问数据。</p> <p>4.与类型无关地函数没有类型检查，所以要确保传递正确类型地数据。</p> <h2 id="编程提示的总结-7"><a href="#编程提示的总结-7" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.避免使用具有副作用的函数。</p> <p>2.一个模块的接口应该避免暴露它的实现细节。</p> <p>3.将数据类型参数化，使它容易修改。</p> <p>4.只有模块对外公布的接口才应该使公用的。</p> <p>5.使用断言来防止非法操作。</p> <p>6.几个不同的实现使用同一个接口使模块具有更强的可互换性。</p> <p>7.服用现有的代码而不是对它进行改写。</p> <p>8.迭代比尾部递归效率更高。</p> <h1 id="_18、运行时环境"><a href="#_18、运行时环境" class="header-anchor">#</a> 18、运行时环境</h1> <p>不同机器生成的汇编代码可能会有所不同</p> <h2 id="_18-1-判断运行时环境"><a href="#_18-1-判断运行时环境" class="header-anchor">#</a> 18.1 判断运行时环境</h2> <h3 id="_18-1-2静态变量和初始化"><a href="#_18-1-2静态变量和初始化" class="header-anchor">#</a> 18.1.2静态变量和初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//静态初始化</span>
<span class="token keyword">int</span> static_variable<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span>data
<span class="token punctuation">.</span>enen
<span class="token punctuation">.</span>global _static_variable
_static_variable<span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token keyword">long</span>   <span class="token number">5</span>
</code></pre></div><p>汇编代码的一开始是两个指令，分别表示进入程序的数据区以及确保变量开始于内存的偶数地址。变量被声明为全局类型，变量名以一个下划线开始。许多C编译器会在C代码所声明的外部名字前加一个下划线，以免与各个库函数所使用的名字冲突。</p> <p>最后，编译器为变量创建控件，并用适当的值对它进行初始化。</p> <h3 id="_18-1-3堆栈帧"><a href="#_18-1-3堆栈帧" class="header-anchor">#</a> 18.1.3堆栈帧</h3> <p>函数分为三部分：函数序(prologue)、函数体(body)、函数跋(epilogue)</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/db2f96e630c148169779ddc511216786.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_13,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>第一条指令( .text )表示进入程序的代码段。为函数创建堆栈帧，堆栈帧是堆栈中的一个区域，里面存入函数的变量和其他值。</p> <p>.globl是函数的全局声明</p> <p>0x3cfc表示寄存器d2到d7、a2到a5中的值需要被存储。（存入堆栈帧）</p> <h3 id="_18-1-4寄存器变量"><a href="#_18-1-4寄存器变量" class="header-anchor">#</a> 18.1.4寄存器变量</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/d2a82b2a7f504abc88437639c2cb81eb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_12,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>1-6存在了一个寄存器中，7-10存到了其他地方。说明最多只能有6个整型值可以被存放在数据寄存器。</p> <p>机器使用的地址模型执行间接寻址和索引操作。这种组合工作颇似数组的下标引用。</p> <p>寄存器a6称为帧指针(frame pointer)，它指向堆栈帧内部的一个&quot;引用&quot;位置。a6@(-28)指定了一个偏移地址-28。这个偏移位置从-4开始，每次增长4。（整型值和指针都占4个字节）</p> <h3 id="_18-1-5外部标识符的长度"><a href="#_18-1-5外部标识符的长度" class="header-anchor">#</a> 18.1.5外部标识符的长度</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/6ab22148f9ee4e28a7fa35b920343256.png#pic_center" loading="lazy" class="lazy"></p> <p>变量名的长度一般没有限制</p> <h3 id="_18-1-6判断堆栈帧布局"><a href="#_18-1-6判断堆栈帧布局" class="header-anchor">#</a> 18.1.6判断堆栈帧布局</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/fb7d25fa4e5e4615862230aca047673e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_9,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>前三条指令把函数的参数压入堆栈。被压入的第1个参数存储于a6@(-16)，包含变量i10。然后被压入的是d7，包含变量i1。</p> <p>pea指令简单地把它的操作数压入堆栈。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/730bfba5a8dc42a38bf815edab84884a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>jbsr是跳转子程序(jump subroutine)。它把返回地址压入堆栈，并跳转到_func_ret_int 的起始位置。当被调用函数结束仍无后需要返回到它的调用位置，就要用到这个压入到堆栈中的返回地址。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/99b65c51a0ef4130a84448c6c75d781f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_10,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h4 id="函数序"><a href="#函数序" class="header-anchor">#</a> 函数序</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/5ac4b52f193c4188b3db5824c5353e2e.png#pic_center" loading="lazy" class="lazy"></p> <p>首先，a6的内容被压入栈中。其次，堆栈指针的当前值被复制到a6</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/043db02c1e054d2ea966ba6d159c7580.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_14,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>最后，link指令从堆栈指针中-8。这将会创建空间用于保存局部变量和被保存的寄存器值。</p> <p>下一条指令把一个单一的寄存器保存到堆栈帧。 0x80指定寄存器d7。寄存器存储在堆栈的顶部，它提示堆栈帧的顶部就是寄存器值保存的位置。堆栈帧剩余的部分必然是局部变量存储的地方。</p> <p>最后(mov指令) 从堆栈复制一个值到d7。</p> <h4 id="堆栈中的参数顺序"><a href="#堆栈中的参数顺序" class="header-anchor">#</a> 堆栈中的参数顺序</h4> <p>被调用函数使用帧指针加一个偏移量来访问参数。当参数以反序压入到堆栈时，参数列表的第1个参数便位于堆栈中这些参数的顶部，它距离帧指针的偏移量是个常数。</p> <h4 id="最终的堆栈帧布局"><a href="#最终的堆栈帧布局" class="header-anchor">#</a> 最终的堆栈帧布局</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/52bb66a4548f40978f535a6a1317dae3.png#pic_center" loading="lazy" class="lazy"></p> <p>第1条movl指令是把第2个参数复制到d0。下一条指令将这个值-6，第3条指令把结果存入局部变量d。d0的作用是计算过程中的&quot;中间结果暂存器&quot;。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/12fec6e95363444a881c7027a10e6cb3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_11,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>接下来的3条指令对return语句进行求值。结果存入d0。</p> <h4 id="函数跋"><a href="#函数跋" class="header-anchor">#</a> 函数跋</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/919b5628fb194e1ba03ae5ff4b123b53.png#pic_center" loading="lazy" class="lazy"></p> <p>当返回到调用程序之后执行的第1条指令就是把12加到堆栈指针。这个假发能把参数值从堆栈中取出。</p> <h4 id="返回值"><a href="#返回值" class="header-anchor">#</a> 返回值</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/9654fe42346a4a63acca44981026d35a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_8,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>这个函数没有参数，所以没有东西压入堆栈。这个函数返回后，d0和d1的值都被保存。double的长度为8，返回需要同时用到d0和d1。</p> <h2 id="_18-2c和汇编语言的接口"><a href="#_18-2c和汇编语言的接口" class="header-anchor">#</a> 18.2C和汇编语言的接口</h2> <h4 id="汇编语言程序调用c"><a href="#汇编语言程序调用c" class="header-anchor">#</a> 汇编语言程序调用C</h4> <p>1.如果寄存器d0、d1、a0、a1保存了重要的值，它们必须在调用C之前进行保存，因为C不会保存它们的值。</p> <p>2.任何函数的参数必须以参数列表相反的顺序压入到堆栈中。</p> <p>3.函数必须由一条&quot;跳转子程序&quot;类型的指令调用，它会把返回地址压入堆栈。</p> <p>4.当C函数返回时，汇编程序必须清楚堆栈中的任何参数。</p> <p>5.如果汇编程序期望接受一个返回值，它将保存在d0。</p> <p>6.任何在调用之前进行过保存的寄存器此时可以恢复。</p> <h4 id="c调用汇编程序"><a href="#c调用汇编程序" class="header-anchor">#</a> C调用汇编程序</h4> <p>1.保存任何你希望修改的寄存器(除了d0、d1、a0、a1)。</p> <p>2.参数值从堆栈中获得，因为调用它的C函数把参数压入堆栈。</p> <p>3.如果函数应该返回一个值，它的值应保存在d0中。</p> <p>4.返回之前，函数必须清楚任何它压入堆栈中的内容。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/1ff9747cc8be4bbe8b8291962bce0a20.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_14,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_18-3运行时效率"><a href="#_18-3运行时效率" class="header-anchor">#</a> 18.3运行时效率</h2> <p>虚拟内存：由操作系统实现，它在需要时把程序的活动部分放入内存并把不活动的部分复制到磁盘中，这样就允许运行大型的程序。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/e37be83bd52343fb98135df9cfd84cbe.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>1.在耗费时间最多的函数中，有些是库函数。</p> <p>2.有些函数之所以耗费了大量的实践是因为它们被调用的次数多。</p> <p>3.有些函数调用的次数并不多，但是每次调用所花费的时间很长。</p> <h2 id="警告的总结-16"><a href="#警告的总结-16" class="header-anchor">#</a> 警告的总结</h2> <p>1.决定 外部标识符最大长度 的是链接器而不是编译器。</p> <p>2.你无法链接由不同编译器产生的程序。</p> <h2 id="编程提示总结-10"><a href="#编程提示总结-10" class="header-anchor">#</a> 编程提示总结</h2> <p>1.使用stdarg实现可变参数列表。</p> <p>2.改进算法比优化代码更有效率。</p> <p>3.使用某种环境特有的技巧会导致程序不可移植。</p> <p>否分配成功。</p> <p>2.数组形式的二叉树节点位置计算公式假定数组的下标从1开始。</p> <p>3.把数据封装于对它进行操纵的模块可以防止用户不正确地访问数据。</p> <p>4.与类型无关地函数没有类型检查，所以要确保传递正确类型地数据。</p> <h2 id="编程提示的总结-8"><a href="#编程提示的总结-8" class="header-anchor">#</a> 编程提示的总结</h2> <p>1.避免使用具有副作用的函数。</p> <p>2.一个模块的接口应该避免暴露它的实现细节。</p> <p>3.将数据类型参数化，使它容易修改。</p> <p>4.只有模块对外公布的接口才应该使公用的。</p> <p>5.使用断言来防止非法操作。</p> <p>6.几个不同的实现使用同一个接口使模块具有更强的可互换性。</p> <p>7.服用现有的代码而不是对它进行改写。</p> <p>8.迭代比尾部递归效率更高。</p> <h1 id="_18、运行时环境-2"><a href="#_18、运行时环境-2" class="header-anchor">#</a> 18、运行时环境</h1> <p>不同机器生成的汇编代码可能会有所不同</p> <h2 id="_18-1-判断运行时环境-2"><a href="#_18-1-判断运行时环境-2" class="header-anchor">#</a> 18.1 判断运行时环境</h2> <h3 id="_18-1-2静态变量和初始化-2"><a href="#_18-1-2静态变量和初始化-2" class="header-anchor">#</a> 18.1.2静态变量和初始化</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token comment">//静态初始化</span>
<span class="token keyword">int</span> static_variable<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span>data
<span class="token punctuation">.</span>enen
<span class="token punctuation">.</span>global _static_variable
_static_variable<span class="token operator">:</span>
<span class="token punctuation">.</span><span class="token keyword">long</span>   <span class="token number">5</span>
</code></pre></div><p>汇编代码的一开始是两个指令，分别表示进入程序的数据区以及确保变量开始于内存的偶数地址。变量被声明为全局类型，变量名以一个下划线开始。许多C编译器会在C代码所声明的外部名字前加一个下划线，以免与各个库函数所使用的名字冲突。</p> <p>最后，编译器为变量创建控件，并用适当的值对它进行初始化。</p> <h3 id="_18-1-3堆栈帧-2"><a href="#_18-1-3堆栈帧-2" class="header-anchor">#</a> 18.1.3堆栈帧</h3> <p>函数分为三部分：函数序(prologue)、函数体(body)、函数跋(epilogue)</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2821c6aa3864495791b72057f087b08b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_13,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>第一条指令( .text )表示进入程序的代码段。为函数创建堆栈帧，堆栈帧是堆栈中的一个区域，里面存入函数的变量和其他值。</p> <p>.globl是函数的全局声明</p> <p>0x3cfc表示寄存器d2到d7、a2到a5中的值需要被存储。（存入堆栈帧）</p> <h3 id="_18-1-4寄存器变量-2"><a href="#_18-1-4寄存器变量-2" class="header-anchor">#</a> 18.1.4寄存器变量</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/91d4c46bcdf04c4382c6cd44d28c9ead.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_12,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>1-6存在了一个寄存器中，7-10存到了其他地方。说明最多只能有6个整型值可以被存放在数据寄存器。</p> <p>机器使用的地址模型执行间接寻址和索引操作。这种组合工作颇似数组的下标引用。</p> <p>寄存器a6称为帧指针(frame pointer)，它指向堆栈帧内部的一个&quot;引用&quot;位置。a6@(-28)指定了一个偏移地址-28。这个偏移位置从-4开始，每次增长4。（整型值和指针都占4个字节）</p> <h3 id="_18-1-5外部标识符的长度-2"><a href="#_18-1-5外部标识符的长度-2" class="header-anchor">#</a> 18.1.5外部标识符的长度</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/c093e565c3484953ad4965fdb9222588.png#pic_center" loading="lazy" class="lazy"></p> <p>变量名的长度一般没有限制</p> <h3 id="_18-1-6判断堆栈帧布局-2"><a href="#_18-1-6判断堆栈帧布局-2" class="header-anchor">#</a> 18.1.6判断堆栈帧布局</h3> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/1e80fada00484e358a581858795fb5a8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_11,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>前三条指令把函数的参数压入堆栈。被压入的第1个参数存储于a6@(-16)，包含变量i10。然后被压入的是d7，包含变量i1。</p> <p>pea指令简单地把它的操作数压入堆栈。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/e00c8110b6694d6dba6cd16a19166a59.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>jbsr是跳转子程序(jump subroutine)。它把返回地址压入堆栈，并跳转到_func_ret_int 的起始位置。当被调用函数结束仍无后需要返回到它的调用位置，就要用到这个压入到堆栈中的返回地址。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/0693fbee23b54c8997d538cd88024f3d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_10,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h4 id="函数序-2"><a href="#函数序-2" class="header-anchor">#</a> 函数序</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2e09d26d1a3a4db288e5003b709e2472.png#pic_center" loading="lazy" class="lazy"></p> <p>首先，a6的内容被压入栈中。其次，堆栈指针的当前值被复制到a6</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/94e767c9ad394c60bac01cd603ed4fef.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_14,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>最后，link指令从堆栈指针中-8。这将会创建空间用于保存局部变量和被保存的寄存器值。</p> <p>下一条指令把一个单一的寄存器保存到堆栈帧。 0x80指定寄存器d7。寄存器存储在堆栈的顶部，它提示堆栈帧的顶部就是寄存器值保存的位置。堆栈帧剩余的部分必然是局部变量存储的地方。</p> <p>最后(mov指令) 从堆栈复制一个值到d7。</p> <h4 id="堆栈中的参数顺序-2"><a href="#堆栈中的参数顺序-2" class="header-anchor">#</a> 堆栈中的参数顺序</h4> <p>被调用函数使用帧指针加一个偏移量来访问参数。当参数以反序压入到堆栈时，参数列表的第1个参数便位于堆栈中这些参数的顶部，它距离帧指针的偏移量是个常数。</p> <h4 id="最终的堆栈帧布局-2"><a href="#最终的堆栈帧布局-2" class="header-anchor">#</a> 最终的堆栈帧布局</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/6de3b4d9b2ab40f6a9421be75d865ecb.png#pic_center" loading="lazy" class="lazy"></p> <p>第1条movl指令是把第2个参数复制到d0。下一条指令将这个值-6，第3条指令把结果存入局部变量d。d0的作用是计算过程中的&quot;中间结果暂存器&quot;。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/e3f218f778f544eca67a8bf5d75ab033.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_11,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>接下来的3条指令对return语句进行求值。结果存入d0。</p> <h4 id="函数跋-2"><a href="#函数跋-2" class="header-anchor">#</a> 函数跋</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/736bffced19a4aaa944fe163ed7dd513.png#pic_center" loading="lazy" class="lazy"></p> <p>当返回到调用程序之后执行的第1条指令就是把12加到堆栈指针。这个假发能把参数值从堆栈中取出。</p> <h4 id="返回值-2"><a href="#返回值-2" class="header-anchor">#</a> 返回值</h4> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/cb1b6504bd204711aea8f2a7823ee5c5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_8,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>这个函数没有参数，所以没有东西压入堆栈。这个函数返回后，d0和d1的值都被保存。double的长度为8，返回需要同时用到d0和d1。</p> <h2 id="_18-2c和汇编语言的接口-2"><a href="#_18-2c和汇编语言的接口-2" class="header-anchor">#</a> 18.2C和汇编语言的接口</h2> <h4 id="汇编语言程序调用c-2"><a href="#汇编语言程序调用c-2" class="header-anchor">#</a> 汇编语言程序调用C</h4> <p>1.如果寄存器d0、d1、a0、a1保存了重要的值，它们必须在调用C之前进行保存，因为C不会保存它们的值。</p> <p>2.任何函数的参数必须以参数列表相反的顺序压入到堆栈中。</p> <p>3.函数必须由一条&quot;跳转子程序&quot;类型的指令调用，它会把返回地址压入堆栈。</p> <p>4.当C函数返回时，汇编程序必须清楚堆栈中的任何参数。</p> <p>5.如果汇编程序期望接受一个返回值，它将保存在d0。</p> <p>6.任何在调用之前进行过保存的寄存器此时可以恢复。</p> <h4 id="c调用汇编程序-2"><a href="#c调用汇编程序-2" class="header-anchor">#</a> C调用汇编程序</h4> <p>1.保存任何你希望修改的寄存器(除了d0、d1、a0、a1)。</p> <p>2.参数值从堆栈中获得，因为调用它的C函数把参数压入堆栈。</p> <p>3.如果函数应该返回一个值，它的值应保存在d0中。</p> <p>4.返回之前，函数必须清楚任何它压入堆栈中的内容。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/0358630ffc9b4ce391b0488aaecab8d0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_14,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <h2 id="_18-3运行时效率-2"><a href="#_18-3运行时效率-2" class="header-anchor">#</a> 18.3运行时效率</h2> <p>虚拟内存：由操作系统实现，它在需要时把程序的活动部分放入内存并把不活动的部分复制到磁盘中，这样就允许运行大型的程序。</p> <p><img alt="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/8b46ef0f59044d3992c2410bb6ca2170.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBASU5GSU5JVEVfV0FS,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center" loading="lazy" class="lazy"></p> <p>1.在耗费时间最多的函数中，有些是库函数。</p> <p>2.有些函数之所以耗费了大量的实践是因为它们被调用的次数多。</p> <p>3.有些函数调用的次数并不多，但是每次调用所花费的时间很长。</p> <h2 id="警告的总结-17"><a href="#警告的总结-17" class="header-anchor">#</a> 警告的总结</h2> <p>1.决定 外部标识符最大长度 的是链接器而不是编译器。</p> <p>2.你无法链接由不同编译器产生的程序。</p> <h2 id="编程提示总结-11"><a href="#编程提示总结-11" class="header-anchor">#</a> 编程提示总结</h2> <p>1.使用stdarg实现可变参数列表。</p> <p>2.改进算法比优化代码更有效率。</p> <p>3.使用某种环境特有的技巧会导致程序不可移植。</p></div> <div class="tail" data-v-3caaac61><div class="ending" data-v-3caaac61><span data-v-3caaac61>The post above ended</span> <i class="far fa-dot-circle fa-fw" data-v-3caaac61></i> <span data-v-3caaac61>Thanks for your reading</span></div> <div class="friend" data-v-3caaac61><div data-v-3caaac61>Come on! Write some comments, and your suggestions will improve the quality of my creative!</div> <div class="button" data-v-3caaac61>FRIEND ME</div> <div class="qrcode" data-v-3caaac61><div data-v-3caaac61><img src="/assets/img/qq.png" data-v-3caaac61> <div data-v-3caaac61>QQ</div></div><div data-v-3caaac61><img src="/assets/img/wechat.png" data-v-3caaac61> <div data-v-3caaac61>WeChat</div></div></div></div> <div class="share" data-v-3caaac61><!----></div> <div class="license" data-v-3caaac61><div class="frame" data-v-3caaac61><div data-v-3caaac61><span data-v-3caaac61>Post Author:</span> <a target="_blank" href="/" data-v-3caaac61>Mitchell</a></div> <div data-v-3caaac61><span data-v-3caaac61>Post Link:</span> <a target="_blank" href="/" data-v-3caaac61>/</a></div> <div data-v-3caaac61><span data-v-3caaac61>Copyright Notice:</span> <span data-v-3caaac61>All articles/posts in this website are licensed under <a target="_blank" href="//creativecommons.org/licenses/by-nc-sa/4.0/"><i class="fab fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</span></div></div></div> <div class="tags" data-v-3caaac61><a href="/tag/C/C++/" data-v-3caaac61># C/C++</a></div> <div class="pn" data-v-3caaac61><!----> <a href="/post/087d73c6e36de9d526d74370af7d3606/#" title="Newer Post: undefined" class="next" data-v-3caaac61></a></div></div> <div class="readmode" data-v-3caaac61><span data-v-3caaac61>Enable Read Mode</span> <i class="fas fa-book-open" data-v-3caaac61></i></div></div></div> <div class="Comment card" data-v-0b506543 data-v-55aed3a6><div class="caption" data-v-0b506543><span class="icon" data-v-0b506543><i class="fas fa-comments fa-fw" data-v-0b506543></i></span> <span data-v-0b506543>COMMENTS</span></div> <div class="inner" data-v-0b506543><!----></div> <div class="minimize" data-v-0b506543></div></div></div></div> <div class="Empty card" style="background-image:url('/assets/img/empty.png');" data-v-22aaa453 data-v-5f6ffb84></div></div> <div class="aside" data-v-5f6ffb84><div class="Aside" data-v-07032a5d data-v-5f6ffb84><div class="Panel" data-v-70581521 data-v-07032a5d><div class="card" data-v-70581521><div class="caption" data-v-70581521><span class="icon" data-v-70581521><i class="fas fa-folder-open fa-fw"></i></span> <span data-v-70581521>CATEGORIES</span></div> <div class="inner" data-v-70581521><a href="/category/语言/" style="font-size:1.1166666666666667rem;opacity:1;" data-v-70581521>语言</a><a href="/category/Blog/" style="font-size:0.9166666666666666rem;opacity:0.7272727272727273;" data-v-70581521>Blog</a><a href="/category/网络/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>网络</a><a href="/category/Note/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>Note</a><a href="/category/前端/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>前端</a><a href="/category/web开发/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>web开发</a><a href="/category/数据库/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>数据库</a><a href="/category/java框架/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>java框架</a><a href="/category/其他/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>其他</a><a href="/category/算法/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>算法</a><a href="/category/后端框架/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>后端框架</a><a href="/category/Spring/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>Spring</a><a href="/category/操作系统/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>操作系统</a><a href="/category/Plugin/" style="font-size:0.8166666666666667rem;opacity:0.5909090909090909;" data-v-70581521>Plugin</a><a href="/category/Hexo/" style="font-size:0.7833333333333333rem;opacity:0.5454545454545454;" data-v-70581521>Hexo</a></div> <!----> <div class="minimize" data-v-70581521></div></div><div class="card" data-v-70581521><div class="caption" data-v-70581521><span class="icon" data-v-70581521><i class="fas fa-tags fa-fw"></i></span> <span data-v-70581521>TAGS</span></div> <!----> <div class="inner" data-v-70581521><a href="/tag/2048/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>2048</a><a href="/tag/JavaSE/" style="font-size:1.0833333333333333rem;opacity:1;" data-v-70581521>JavaSE</a><a href="/tag/Test/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>Test</a><a href="/tag/HTTP/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>HTTP</a><a href="/tag/HTTPS/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>HTTPS</a><a href="/tag/Links/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>Links</a><a href="/tag/JavaScript/" style="font-size:0.85rem;opacity:0.65;" data-v-70581521>JavaScript</a><a href="/tag/JavaWeb/" style="font-size:0.8166666666666667rem;opacity:0.6;" data-v-70581521>JavaWeb</a><a href="/tag/JavaEE/" style="font-size:0.85rem;opacity:0.65;" data-v-70581521>JavaEE</a><a href="/tag/XML/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>XML</a><a href="/tag/vuepressBlog/" style="font-size:0.8166666666666667rem;opacity:0.6;" data-v-70581521>vuepressBlog</a><a href="/tag/娱乐/" style="font-size:0.8166666666666667rem;opacity:0.6;" data-v-70581521>娱乐</a><a href="/tag/高中回忆/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>高中回忆</a><a href="/tag/algorithm/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>algorithm</a><a href="/tag/操作系统/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>操作系统</a><a href="/tag/command/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>command</a><a href="/tag/数据库/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>数据库</a><a href="/tag/SQL/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>SQL</a><a href="/tag/C/C++/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>C/C++</a><a href="/tag/音乐播放器/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>音乐播放器</a><a href="/tag/old blog/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>old blog</a><a href="/tag/diary/" style="font-size:0.7833333333333333rem;opacity:0.55;" data-v-70581521>diary</a></div> <div class="minimize" data-v-70581521></div></div></div> <div class="Audioplayer card" data-v-18c8023d data-v-07032a5d><div class="caption" data-v-18c8023d><span class="icon" data-v-18c8023d><i class="fas fa-music fa-fw" data-v-18c8023d></i></span> <span data-v-18c8023d>PLAYLIST</span></div> <div class="inner" style="height:calc(297px + 90px);" data-v-18c8023d><meting-js server="netease"type="playlist"id="7256148570"theme="var(--link)"list-max-height="297px"></meting-js></div> <div class="minimize" data-v-18c8023d></div></div> <!----> <div class="Toc card" data-v-022f25d3 data-v-07032a5d data-v-07032a5d><div class="caption" data-v-022f25d3><span class="icon" data-v-022f25d3><i class="fas fa-bookmark fa-fw" data-v-022f25d3></i></span> <span data-v-022f25d3>TABLE OF CONTENTS</span></div> <div class="inner" data-v-022f25d3><div data-v-022f25d3><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_1、快速上手">1、快速上手</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告与总结">警告与总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_2、基本概念">2、基本概念</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_2-1-环境">2.1 环境</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_2-1-1-翻译环境">2.1.1 翻译环境</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_2-1-2-执行环境">2.1.2 执行环境</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_2-2-词法规则">2.2 词法规则</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#三字母词">三字母词</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3、数据">3、数据</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-1-基本数据类型">3.1 基本数据类型</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-1-1-整型">3.1.1 整型</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#整型字面值">整型字面值</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#枚举类型-enumerated">枚举类型(enumerated)</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-1-2-浮点类型">3.1.2 浮点类型</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-1-3-指针">3.1.3 指针</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#指针常量">指针常量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#字符串常量">字符串常量</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-2声明">3.2声明</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-2-2数组声明">3.2.2数组声明</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-2-3-指针声明">3.2.3 指针声明</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-2-4隐式声明">3.2.4隐式声明</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-3-typedef">3.3 typedef</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-4-常量">3.4 常量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-6-链接属性">3.6 链接属性</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-7-存储类型">3.7 存储类型</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#初始化">初始化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-8-static-关键字">3.8 static 关键字</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_3-10-小结">3.10 小结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_4、语句">4、语句</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-2">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-2">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5、操作符和表达式">5、操作符和表达式</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1操作符">5.1操作符</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-1算术操作符">5.1.1算术操作符</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-2移位操作符">5.1.2移位操作符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-3-位操作符">5.1.3 位操作符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-4赋值">5.1.4赋值</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-8-条件操作符">5.1.8 条件操作符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-9-逗号操作符">5.1.9 逗号操作符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-1-10-下标引用、函数调用和结构成员">5.1.10 下标引用、函数调用和结构成员</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-3左值和右值">5.3左值和右值</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-4-表达式求值">5.4 表达式求值</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-4-1隐式类型转换">5.4.1隐式类型转换</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-4-2-算术转换">5.4.2 算术转换</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_5-4-3操作符的属性">5.4.3操作符的属性</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-3">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-3">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6、指针">6、指针</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-1-内存和地址">6.1 内存和地址</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-4-间接访问操作符">6.4 间接访问操作符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-5-未初始化和非法指针">6.5 未初始化和非法指针</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-6null指针">6.6NULL指针</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-7指针、间接访问和左值">6.7指针、间接访问和左值</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-8指针、间接访问和变量">6.8指针、间接访问和变量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-9指针常量">6.9指针常量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-10指针表达式">6.10指针表达式</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_6-13指针运算">6.13指针运算</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-4">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-2">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_7、函数">7、函数</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_7-5递归和迭代">7.5递归和迭代</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_7-6可变参数列表">7.6可变参数列表</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_7-6-1-stdarg宏">7.6.1 stdarg宏</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-5">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-3">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8、数组">8、数组</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-1一维数组">8.1一维数组</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-1-2-下标引用">8.1.2 下标引用</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-1-5-数组和指针">8.1.5 数组和指针</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-1-8初始化">8.1.8初始化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-2多维数组">8.2多维数组</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-2-3-下标">8.2.3 下标</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-2-4指向数组的指针">8.2.4指向数组的指针</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-2-5作为函数参数的多维数组">8.2.5作为函数参数的多维数组</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-2-6初始化">8.2.6初始化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_8-3指针数组">8.3指针数组</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-6">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-4">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9、字符串、字符和字节">9、字符串、字符和字节</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-2字符串长度">9.2字符串长度</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-5字符串查找基础">9.5字符串查找基础</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-5-1查找一个字符">9.5.1查找一个字符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-5-2查找任何几个字符">9.5.2查找任何几个字符</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-5-3查找一个字串">9.5.3查找一个字串</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-6高级字符串查找">9.6高级字符串查找</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-6-1查找一个字符串前缀">9.6.1查找一个字符串前缀</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-6-2查找标记">9.6.2查找标记</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-7错误信息">9.7错误信息</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-8字符操作">9.8字符操作</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-8-1字符分类">9.8.1字符分类</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-8-2字符转换">9.8.2字符转换</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_9-9内存操作">9.9内存操作</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-7">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-4">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10、结构体和联合">10、结构体和联合</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1结构体基础">10.1结构体基础</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1-1结构体声明">10.1.1结构体声明</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1-3成员访问">10.1.3成员访问</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1-5结构体自引用">10.1.5结构体自引用</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1-6不完整声明">10.1.6不完整声明</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-1-7结构体初始化">10.1.7结构体初始化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-3结构的存储分配">10.3结构的存储分配</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-4作为函数参数">10.4作为函数参数</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-5位段">10.5位段</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-6联合">10.6联合</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_10-6-2初始化">10.6.2初始化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-8">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-5">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_11、动态内存分配">11、动态内存分配</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_11-3calloc和realloc">11.3calloc和realloc</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_11-4使用例">11.4使用例</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_11-5常见的动态内存错误">11.5常见的动态内存错误</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#不要访问被free释放的内存">不要访问被free释放的内存</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#内存泄漏">内存泄漏</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-9">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-6">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_12、使用结构和指针">12、使用结构和指针</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_12-3双链表">12.3双链表</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_12-3-1双链表插入操作的优化">12.3.1双链表插入操作的优化</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-10">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-5">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13、高级指针话题">13、高级指针话题</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-2高级声明">13.2高级声明</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-3函数指针">13.3函数指针</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-3-1回调函数">13.3.1回调函数</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-1-2转换表">13.1.2转换表</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-4命令行参数">13.4命令行参数</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_13-5字符串常量">13.5字符串常量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-11">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-7">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14、预处理器">14、预处理器</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-1预定义符号">14.1预定义符号</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#define">#define</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-2-1宏">14.2.1宏</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-2-6-undef">14.2.6#undef</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-3条件编译">14.3条件编译</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-3-1是否被定义">14.3.1是否被定义</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-4文件包含">14.4文件包含</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#避免多重包含">避免多重包含</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_14-5其他指令">14.5其他指令</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-12">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-6">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15、输入-输出函数">15、输入/输出函数</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-1错误报告">15.1错误报告</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-2终止执行">15.2终止执行</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-4-ansi-i-o概念">15.4 ANSI I/O概念</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-4-1流">15.4.1流</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-4-2文件">15.4.2文件</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-4-3标准i-o常量">15.4.3标准I/O常量</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-5流i-o总览">15.5流I/O总览</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-6打开流">15.6打开流</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-7关闭流">15.7关闭流</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-8字符i-o">15.8字符I/O</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-9未格式化的行i-o">15.9未格式化的行I/O</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-10格式化的行i-o">15.10格式化的行I/O</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-10-1-scanf族">15.10.1 scanf族</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-10-3-printf族">15.10.3 printf族</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-11二进制i-o">15.11二进制I/O</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-12刷新和定位函数">15.12刷新和定位函数</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-13改变缓冲方式">15.13改变缓冲方式</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-14流错误函数">15.14流错误函数</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-15临时文件">15.15临时文件</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_15-16-文件操纵函数">15.16 文件操纵函数</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-13">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-8">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_16、标准函数库">16、标准函数库</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-14">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-9">编程提示总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17、经典抽象数据类型">17、经典抽象数据类型</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-1堆栈">17.1堆栈</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#接口">接口</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-1-1静态数组实现">17.1.1静态数组实现</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-1-2动态数组实现">17.1.2动态数组实现</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-1-3链式堆栈">17.1.3链式堆栈</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-2队列">17.2队列</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#接口-2">接口</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-2-1静态数组实现">17.2.1静态数组实现</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-3树">17.3树</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#接口-3">接口</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-3-1静态数组实现">17.3.1静态数组实现</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-3-2链表实现">17.3.2链表实现</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_17-4-实现的改进">17.4 实现的改进</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-15">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-7">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18、运行时环境">18、运行时环境</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-判断运行时环境">18.1 判断运行时环境</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-2静态变量和初始化">18.1.2静态变量和初始化</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-3堆栈帧">18.1.3堆栈帧</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-4寄存器变量">18.1.4寄存器变量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-5外部标识符的长度">18.1.5外部标识符的长度</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-6判断堆栈帧布局">18.1.6判断堆栈帧布局</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#函数序">函数序</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#堆栈中的参数顺序">堆栈中的参数顺序</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#最终的堆栈帧布局">最终的堆栈帧布局</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#函数跋">函数跋</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#返回值">返回值</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-2c和汇编语言的接口">18.2C和汇编语言的接口</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#汇编语言程序调用c">汇编语言程序调用C</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#c调用汇编程序">C调用汇编程序</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-3运行时效率">18.3运行时效率</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-16">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-10">编程提示总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示的总结-8">编程提示的总结</a></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18、运行时环境-2">18、运行时环境</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-判断运行时环境-2">18.1 判断运行时环境</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-2静态变量和初始化-2">18.1.2静态变量和初始化</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-3堆栈帧-2">18.1.3堆栈帧</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-4寄存器变量-2">18.1.4寄存器变量</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-5外部标识符的长度-2">18.1.5外部标识符的长度</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-1-6判断堆栈帧布局-2">18.1.6判断堆栈帧布局</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#函数序-2">函数序</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#堆栈中的参数顺序-2">堆栈中的参数顺序</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#最终的堆栈帧布局-2">最终的堆栈帧布局</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#函数跋-2">函数跋</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#返回值-2">返回值</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-2c和汇编语言的接口-2">18.2C和汇编语言的接口</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#汇编语言程序调用c-2">汇编语言程序调用C</a><ul><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#c调用汇编程序-2">C调用汇编程序</a></li></ul></li></ul></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#_18-3运行时效率-2">18.3运行时效率</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#警告的总结-17">警告的总结</a></li><li><a href="/post/087d73c6e36de9d526d74370af7d3606/#编程提示总结-11">编程提示总结</a></li></ul></li></ul></div></div></div></div></div> <div class="footer" data-v-5f6ffb84><div data-v-5f6ffb84><div class="Footer" data-v-1e7563d3 data-v-5f6ffb84><div data-v-1e7563d3>© 2019 - 2022 Mitchell</div> <div data-v-1e7563d3></div> <div data-v-1e7563d3>Theme <a target="_blank" href="//github.com/jinyaoMa/vuepress-theme-mustom" title="vuepress-theme-mustom">Mustom</a> By <a target="_blank" href="//github.com/jinyaoMa" title="jinyaoMa">jinyaoMa</a></div> <div class="footerCount" data-v-1e7563d3><span title="Site total page views" data-v-1e7563d3><i class="fas fa-eye fa-fw" data-v-1e7563d3></i>
      ∞
    </span> <span title="Site total visitors" data-v-1e7563d3><i class="fas fa-user-tie fa-fw" data-v-1e7563d3></i>
      ∞
    </span> <span title="Site total word count" data-v-1e7563d3><i class="fas fa-file-word fa-fw" data-v-1e7563d3></i>
      130.2k
    </span></div> <div class="license" data-v-1e7563d3><a class="by-nc-sa" target="_blank" href="//creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution-Noncommercial-ShareAlike 4.0 International license"></a></div></div></div></div></div></div> <div class="Notification default hide" data-v-1c9c144c data-v-5f6ffb84><div class="frame" data-v-1c9c144c><div class="inner" data-v-1c9c144c><div class="icon" data-v-1c9c144c><i class="fas fa-exclamation-circle fa-fw"></i></div> <div class="msg" data-v-1c9c144c>DEFAULT</div></div></div></div></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:48px;bottom:0px;width:180px;height:270px;z-index:99999;opacity:1;pointer-events:none;"><canvas id="live2d_canvas" width="180" height="270" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:180px;height:270px;"></canvas></div></div></div>
    <script src="./assets/js/app.152d2abe.js" defer></script><script src="./assets/js/5.45f84343.js" defer></script><script src="./assets/js/35.4683a28e.js" defer></script><script src="./assets/js/10.e02dcdbc.js" defer></script><script src="./assets/js/7.6b3198e2.js" defer></script>
  </body>
</html>
